<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">{-| Many actions in base monad transformers cannot be automatically
    'Control.Monad.Trans.Class.lift'ed.  These functions lift these remaining
    actions so that they work in the 'Proxy' monad transformer.

    See the mini-tutorial at the bottom of this module for example code and
    typical use cases where this module will come in handy.
-}</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Pipes</span><span class="hs-operator">.</span><span class="hs-identifier">Lift</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-13"></a><span>      </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-comment">-- * ExceptT</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#exceptP"><span class="hs-identifier hs-var">exceptP</span></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runExceptP"><span class="hs-identifier hs-var">runExceptP</span></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#catchError"><span class="hs-identifier hs-var">catchError</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#liftCatchError"><span class="hs-identifier hs-var">liftCatchError</span></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-comment">-- * MaybeT</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#maybeP"><span class="hs-identifier hs-var">maybeP</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runMaybeP"><span class="hs-identifier hs-var">runMaybeP</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-comment">-- * ReaderT</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#readerP"><span class="hs-identifier hs-var">readerP</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runReaderP"><span class="hs-identifier hs-var">runReaderP</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-comment">-- * StateT</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#stateP"><span class="hs-identifier hs-var">stateP</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runStateP"><span class="hs-identifier hs-var">runStateP</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#evalStateP"><span class="hs-identifier hs-var">evalStateP</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#execStateP"><span class="hs-identifier hs-var">execStateP</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-comment">-- * WriterT</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-comment">-- $writert</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#writerP"><span class="hs-identifier hs-var">writerP</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runWriterP"><span class="hs-identifier hs-var">runWriterP</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#execWriterP"><span class="hs-identifier hs-var">execWriterP</span></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- * RWST</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#rwsP"><span class="hs-identifier hs-var">rwsP</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#runRWSP"><span class="hs-identifier hs-var">runRWSP</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#evalRWSP"><span class="hs-identifier hs-var">evalRWSP</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Pipes.Lift.html#execRWSP"><span class="hs-identifier hs-var">execRWSP</span></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- * Tutorial</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- $tutorial</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lift</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">E</span><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Reader</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">R</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Writer</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">W</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">RWS</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">RWS</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><a href="Pipes.Internal.html"><span class="hs-identifier">Pipes</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Morph</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hoist</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MFunctor</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span> </span><a href="Pipes.Core.html"><span class="hs-identifier">Pipes</span><span class="hs-operator">.</span><span class="hs-identifier">Core</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Core.html#runEffect"><span class="hs-identifier hs-var">runEffect</span></a><span class="hs-special">,</span><span> </span><a href="Pipes.Core.html#request"><span class="hs-identifier hs-var">request</span></a><span class="hs-special">,</span><span> </span><a href="Pipes.Core.html#respond"><span class="hs-identifier hs-var">respond</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Pipes.Core.html#%2F%2F%3E"><span class="hs-operator hs-var">//&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Pipes.Core.html#%3E%5C%5C"><span class="hs-operator hs-var">&gt;\\</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-63"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-65"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Distribute 'Proxy' over a monad transformer</span><span>
</span><a name="line-68"></a><span class="hs-identifier">distribute</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-70"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadTrans</span><span> </span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-71"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MFunctor</span><span> </span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-72"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061263"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061264"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061265"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061266"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061263"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061264"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061265"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061266"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061267"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-comment">-- ^ </span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061262"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061263"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061264"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061265"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061266"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061267"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-comment">-- ^ </span><span>
</span><a name="line-79"></a><a name="distribute"><a href="Pipes.Lift.html#distribute"><span class="hs-identifier">distribute</span></a></a><span> </span><a name="local-6989586621679061268"><a href="#local-6989586621679061268"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="Pipes.Core.html#runEffect"><span class="hs-identifier hs-var">runEffect</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679061269"><span class="hs-identifier hs-var">request'</span></a><span> </span><a href="Pipes.Core.html#%3E%5C%5C"><span class="hs-operator hs-var">&gt;\\</span></a><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hoist</span><span> </span><span class="hs-identifier hs-var">lift</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061268"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Pipes.Core.html#%2F%2F%3E"><span class="hs-operator hs-var">//&gt;</span></a><span> </span><a href="#local-6989586621679061270"><span class="hs-identifier hs-var">respond'</span></a><span>
</span><a name="line-80"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-81"></a><span>    </span><a name="local-6989586621679061269"><a href="#local-6989586621679061269"><span class="hs-identifier">request'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pipes.Core.html#request"><span class="hs-identifier hs-var">request</span></a><span>
</span><a name="line-82"></a><span>    </span><a name="local-6989586621679061270"><a href="#local-6989586621679061270"><span class="hs-identifier">respond'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pipes.Core.html#respond"><span class="hs-identifier hs-var">respond</span></a><span>
</span><a name="line-83"></a><span class="hs-pragma">{-# INLINABLE distribute #-}</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | Wrap the base monad in 'E.ExceptT'</span><span>
</span><a name="line-86"></a><span class="hs-identifier">exceptP</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061254"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061255"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061256"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061257"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061258"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061254"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679061259"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061260"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061255"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061256"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061257"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061258"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679061259"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061254"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061260"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-90"></a><a name="exceptP"><a href="Pipes.Lift.html#exceptP"><span class="hs-identifier">exceptP</span></a></a><span> </span><a name="local-6989586621679061271"><a href="#local-6989586621679061271"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-91"></a><span>    </span><a name="local-6989586621679061272"><a href="#local-6989586621679061272"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="#local-6989586621679061271"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ExceptT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679061272"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-pragma">{-# INLINABLE exceptP #-}</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Run 'E.ExceptT' in the base monad</span><span>
</span><a name="line-96"></a><span class="hs-identifier">runExceptP</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061247"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061248"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061249"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061250"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679061252"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061247"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061253"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061248"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061249"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061250"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061247"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679061252"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061253"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><a name="runExceptP"><a href="Pipes.Lift.html#runExceptP"><span class="hs-identifier">runExceptP</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><span>
</span><a name="line-101"></a><span class="hs-pragma">{-# INLINABLE runExceptP #-}</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Catch an error in the base monad</span><span>
</span><a name="line-104"></a><span class="hs-identifier">catchError</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061242"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061243"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679061245"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061246"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-comment">-- ^</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061245"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061242"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061243"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679061245"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061246"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-comment">-- ^</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061242"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061243"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">E</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679061245"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679061240"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061246"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-111"></a><a name="catchError"><a href="Pipes.Lift.html#catchError"><span class="hs-identifier">catchError</span></a></a><span> </span><a name="local-6989586621679061273"><a href="#local-6989586621679061273"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679061274"><a href="#local-6989586621679061274"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Pipes.Lift.html#exceptP"><span class="hs-identifier hs-var">exceptP</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier hs-var">E</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">catchE</span><span> </span><span class="hs-special">(</span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-pragma">{-# INLINABLE catchError #-}</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | Catch an error using a catch function for the base monad</span><span>
</span><a name="line-116"></a><span class="hs-identifier">liftCatchError</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span>   </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061239"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-comment">-- ^</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-glyph">-&gt;</span><span>    </span><span class="hs-special">(</span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-123"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061239"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061234"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061233"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061238"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-comment">-- ^</span><span>
</span><a name="line-126"></a><a name="liftCatchError"><a href="Pipes.Lift.html#liftCatchError"><span class="hs-identifier">liftCatchError</span></a></a><span> </span><a name="local-6989586621679061275"><a href="#local-6989586621679061275"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679061276"><a href="#local-6989586621679061276"><span class="hs-identifier">p0</span></a></a><span> </span><a name="local-6989586621679061277"><a href="#local-6989586621679061277"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679061276"><span class="hs-identifier hs-var">p0</span></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><a name="local-6989586621679061278"><a href="#local-6989586621679061278"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679061279"><a href="#local-6989586621679061279"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679061279"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-129"></a><span>        </span><a href="Pipes.Internal.html#Request"><span class="hs-identifier hs-var">Request</span></a><span> </span><a name="local-6989586621679061280"><a href="#local-6989586621679061280"><span class="hs-identifier">a'</span></a></a><span> </span><a name="local-6989586621679061281"><a href="#local-6989586621679061281"><span class="hs-identifier">fa</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Request"><span class="hs-identifier hs-var">Request</span></a><span> </span><a href="#local-6989586621679061280"><span class="hs-identifier hs-var">a'</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679061282"><a href="#local-6989586621679061282"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061281"><span class="hs-identifier hs-var">fa</span></a><span>  </span><a href="#local-6989586621679061282"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>        </span><a href="Pipes.Internal.html#Respond"><span class="hs-identifier hs-var">Respond</span></a><span> </span><a name="local-6989586621679061283"><a href="#local-6989586621679061283"><span class="hs-identifier">b</span></a></a><span>  </span><a name="local-6989586621679061284"><a href="#local-6989586621679061284"><span class="hs-identifier">fb'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Respond"><span class="hs-identifier hs-var">Respond</span></a><span> </span><a href="#local-6989586621679061283"><span class="hs-identifier hs-var">b</span></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679061285"><a href="#local-6989586621679061285"><span class="hs-identifier">b'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061284"><span class="hs-identifier hs-var">fb'</span></a><span> </span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">b'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>        </span><a href="Pipes.Internal.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span>    </span><a name="local-6989586621679061286"><a href="#local-6989586621679061286"><span class="hs-identifier">r</span></a></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Pure"><span class="hs-identifier hs-var">Pure</span></a><span> </span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-132"></a><span>        </span><a href="Pipes.Internal.html#M"><span class="hs-identifier hs-var">M</span></a><span>          </span><a name="local-6989586621679061287"><a href="#local-6989586621679061287"><span class="hs-identifier">m</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#M"><span class="hs-identifier hs-var">M</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-133"></a><span>            </span><a name="local-6989586621679061288"><a href="#local-6989586621679061288"><span class="hs-identifier">p'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679061287"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-134"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061278"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679061288"><span class="hs-identifier hs-var">p'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679061275"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679061289"><a href="#local-6989586621679061289"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061277"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679061289"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span class="hs-pragma">{-# INLINABLE liftCatchError #-}</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Wrap the base monad in 'M.MaybeT'</span><span>
</span><a name="line-138"></a><span class="hs-identifier">maybeP</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061228"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061229"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061230"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679061232"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061228"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061229"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061230"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679061227"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061232"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-141"></a><a name="maybeP"><a href="Pipes.Lift.html#maybeP"><span class="hs-identifier">maybeP</span></a></a><span> </span><a name="local-6989586621679061290"><a href="#local-6989586621679061290"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-6989586621679061291"><a href="#local-6989586621679061291"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="#local-6989586621679061290"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">MaybeT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679061291"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span class="hs-pragma">{-# INLINABLE maybeP #-}</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Run 'M.MaybeT' in the base monad</span><span>
</span><a name="line-147"></a><span class="hs-identifier">runMaybeP</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061221"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061222"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061223"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061224"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061225"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">M</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679061221"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061226"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061222"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061223"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061224"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061225"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061221"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679061226"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><a name="runMaybeP"><a href="Pipes.Lift.html#runMaybeP"><span class="hs-identifier">runMaybeP</span></a></a><span> </span><a name="local-6989586621679061292"><a href="#local-6989586621679061292"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">M</span><span class="hs-operator">.</span><span class="hs-identifier">runMaybeT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061292"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-152"></a><span class="hs-pragma">{-# INLINABLE runMaybeP #-}</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span class="hs-comment">-- | Wrap the base monad in 'R.ReaderT'</span><span>
</span><a name="line-155"></a><span class="hs-identifier">readerP</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061214"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-157"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061215"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061216"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061217"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061218"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061219"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061214"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061220"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061216"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061217"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061218"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061219"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">R</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679061215"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679061214"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061220"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-158"></a><a name="readerP"><a href="Pipes.Lift.html#readerP"><span class="hs-identifier">readerP</span></a></a><span> </span><a name="local-6989586621679061293"><a href="#local-6989586621679061293"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-159"></a><span>    </span><a name="local-6989586621679061294"><a href="#local-6989586621679061294"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-identifier hs-var">R</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-160"></a><span>    </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061293"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679061294"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span class="hs-pragma">{-# INLINABLE readerP #-}</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | Run 'R.ReaderT' in the base monad</span><span>
</span><a name="line-164"></a><span class="hs-identifier">runReaderP</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061207"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-166"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061208"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-167"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061209"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061210"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061211"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061212"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">R</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679061208"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679061207"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061213"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-168"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061209"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061210"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061211"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061212"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061207"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061213"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-169"></a><a name="runReaderP"><a href="Pipes.Lift.html#runReaderP"><span class="hs-identifier">runReaderP</span></a></a><span> </span><a name="local-6989586621679061295"><a href="#local-6989586621679061295"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679061296"><a href="#local-6989586621679061296"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">R</span><span class="hs-operator">.</span><span class="hs-identifier">runReaderT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679061295"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061296"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-170"></a><span class="hs-pragma">{-# INLINABLE runReaderP #-}</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | Wrap the base monad in 'S.StateT'</span><span>
</span><a name="line-173"></a><span class="hs-identifier">stateP</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061200"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061201"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061202"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061203"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061204"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061205"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061200"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061206"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061201"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061202"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061203"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061204"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061205"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679061201"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061200"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061206"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-176"></a><a name="stateP"><a href="Pipes.Lift.html#stateP"><span class="hs-identifier">stateP</span></a></a><span> </span><a name="local-6989586621679061297"><a href="#local-6989586621679061297"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-177"></a><span>    </span><a name="local-6989586621679061298"><a href="#local-6989586621679061298"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-identifier hs-var">S</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679061299"><a href="#local-6989586621679061299"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679061300"><a href="#local-6989586621679061300"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061297"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679061298"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>    </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">S</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">put</span><span> </span><a href="#local-6989586621679061300"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679061299"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-181"></a><span class="hs-pragma">{-# INLINABLE stateP #-}</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | Run 'S.StateT' in the base monad</span><span>
</span><a name="line-184"></a><span class="hs-identifier">runStateP</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061193"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-186"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061194"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-187"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061195"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061196"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061197"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061198"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679061194"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061193"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061199"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-188"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061195"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061196"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061197"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061198"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061193"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061199"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061194"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><a name="runStateP"><a href="Pipes.Lift.html#runStateP"><span class="hs-identifier">runStateP</span></a></a><span> </span><a name="local-6989586621679061301"><a href="#local-6989586621679061301"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061302"><a href="#local-6989586621679061302"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">S</span><span class="hs-operator">.</span><span class="hs-identifier">runStateT</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679061301"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061302"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-190"></a><span class="hs-pragma">{-# INLINABLE runStateP #-}</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">-- | Evaluate 'S.StateT' in the base monad</span><span>
</span><a name="line-193"></a><span class="hs-identifier">evalStateP</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061186"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-195"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061187"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-196"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061188"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061189"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061190"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061191"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679061187"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061186"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061192"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061188"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061189"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061190"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061191"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061186"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061192"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-198"></a><a name="evalStateP"><a href="Pipes.Lift.html#evalStateP"><span class="hs-identifier">evalStateP</span></a></a><span> </span><a name="local-6989586621679061303"><a href="#local-6989586621679061303"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061304"><a href="#local-6989586621679061304"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#runStateP"><span class="hs-identifier hs-var">runStateP</span></a><span> </span><a href="#local-6989586621679061303"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061304"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-199"></a><span class="hs-pragma">{-# INLINABLE evalStateP #-}</span><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-- | Execute 'S.StateT' in the base monad</span><span>
</span><a name="line-202"></a><span class="hs-identifier">execStateP</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061179"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-204"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061180"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-205"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061181"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061182"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061183"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061184"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">S</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679061180"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061179"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061185"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-206"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061181"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061182"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061183"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061184"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061179"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061180"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-207"></a><a name="execStateP"><a href="Pipes.Lift.html#execStateP"><span class="hs-identifier">execStateP</span></a></a><span> </span><a name="local-6989586621679061316"><a href="#local-6989586621679061316"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061317"><a href="#local-6989586621679061317"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#runStateP"><span class="hs-identifier hs-var">runStateP</span></a><span> </span><a href="#local-6989586621679061316"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061317"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-208"></a><span class="hs-pragma">{-# INLINABLE execStateP #-}</span><span>
</span><a name="line-209"></a><span>
</span><a name="line-210"></a><span class="hs-comment">{- $writert
    Note that 'runWriterP' and 'execWriterP' will keep the accumulator in
    weak-head-normal form so that folds run in constant space when possible.

    This means that until @transformers@ adds a truly strict 'W.WriterT', you
    should consider unwrapping 'W.WriterT' first using 'runWriterP' or
    'execWriterP' before running your 'Proxy'.  You will get better performance
    this way and eliminate space leaks if your accumulator doesn't have any lazy
    fields.
-}</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-comment">-- | Wrap the base monad in 'W.WriterT'</span><span>
</span><a name="line-222"></a><span class="hs-identifier">writerP</span><span>
</span><a name="line-223"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061172"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061173"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061174"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061175"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061176"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061177"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061172"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061178"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061173"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061174"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061175"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061176"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061177"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">W</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679061173"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061172"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061178"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-225"></a><a name="writerP"><a href="Pipes.Lift.html#writerP"><span class="hs-identifier">writerP</span></a></a><span> </span><a name="local-6989586621679061318"><a href="#local-6989586621679061318"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-226"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679061319"><a href="#local-6989586621679061319"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679061320"><a href="#local-6989586621679061320"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="#local-6989586621679061318"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-227"></a><span>    </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">W</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tell</span><span> </span><a href="#local-6989586621679061320"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-228"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679061319"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-229"></a><span class="hs-pragma">{-# INLINABLE writerP #-}</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- | Run 'W.WriterT' in the base monad</span><span>
</span><a name="line-232"></a><span class="hs-identifier">runWriterP</span><span>
</span><a name="line-233"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061165"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061166"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061167"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061168"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061169"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061170"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">W</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679061166"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061165"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061171"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061167"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061168"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061169"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061170"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061165"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061171"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061166"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-236"></a><a name="runWriterP"><a href="Pipes.Lift.html#runWriterP"><span class="hs-identifier">runWriterP</span></a></a><span> </span><a name="local-6989586621679061321"><a href="#local-6989586621679061321"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">W</span><span class="hs-operator">.</span><span class="hs-identifier">runWriterT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061321"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-237"></a><span class="hs-pragma">{-# INLINABLE runWriterP #-}</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | Execute 'W.WriterT' in the base monad</span><span>
</span><a name="line-240"></a><span class="hs-identifier">execWriterP</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061158"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061159"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061160"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061161"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061162"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061163"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">W</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679061159"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061158"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061164"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-243"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061160"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061161"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061162"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061163"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061158"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679061159"><span class="hs-identifier hs-type">w</span></a><span>
</span><a name="line-244"></a><a name="execWriterP"><a href="Pipes.Lift.html#execWriterP"><span class="hs-identifier">execWriterP</span></a></a><span> </span><a name="local-6989586621679061322"><a href="#local-6989586621679061322"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#runWriterP"><span class="hs-identifier hs-var">runWriterP</span></a><span> </span><a href="#local-6989586621679061322"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-245"></a><span class="hs-pragma">{-# INLINABLE execWriterP #-}</span><span>
</span><a name="line-246"></a><span>
</span><a name="line-247"></a><span class="hs-comment">-- | Wrap the base monad in 'RWS.RWST'</span><span>
</span><a name="line-248"></a><span class="hs-identifier">rwsP</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061149"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061150"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061151"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061152"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061153"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061154"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061155"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061156"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061149"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061157"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061152"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061150"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061153"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061154"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061155"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061156"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679061151"><span class="hs-identifier hs-type">i</span></a><span> </span><a href="#local-6989586621679061150"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061152"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061149"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061157"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-252"></a><a name="rwsP"><a href="Pipes.Lift.html#rwsP"><span class="hs-identifier">rwsP</span></a></a><span> </span><a name="local-6989586621679061323"><a href="#local-6989586621679061323"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-253"></a><span>    </span><a name="local-6989586621679061324"><a href="#local-6989586621679061324"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-identifier hs-var">RWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ask</span><span>
</span><a name="line-254"></a><span>    </span><a name="local-6989586621679061325"><a href="#local-6989586621679061325"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-identifier hs-var">RWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679061326"><a href="#local-6989586621679061326"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679061327"><a href="#local-6989586621679061327"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679061328"><a href="#local-6989586621679061328"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Pipes.Internal.html#unsafeHoist"><span class="hs-identifier hs-var">unsafeHoist</span></a><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061323"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679061324"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061325"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-257"></a><span>        </span><span class="hs-identifier hs-var">RWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">put</span><span> </span><a href="#local-6989586621679061327"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-258"></a><span>        </span><span class="hs-identifier hs-var">RWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tell</span><span> </span><a href="#local-6989586621679061328"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-259"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679061326"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-260"></a><span class="hs-pragma">{-# INLINABLE rwsP #-}</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- | Run 'RWS.RWST' in the base monad</span><span>
</span><a name="line-263"></a><span class="hs-identifier">runRWSP</span><span>
</span><a name="line-264"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061140"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061141"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061142"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061143"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-267"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061144"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061145"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061146"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061147"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679061142"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679061141"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061143"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061140"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061148"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-268"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061144"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061145"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061146"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061147"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061140"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061148"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061143"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061141"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><a name="runRWSP"><a href="Pipes.Lift.html#runRWSP"><span class="hs-identifier">runRWSP</span></a></a><span>  </span><a name="local-6989586621679061329"><a href="#local-6989586621679061329"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061330"><a href="#local-6989586621679061330"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061331"><a href="#local-6989586621679061331"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679061332"><a href="#local-6989586621679061332"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">RWS</span><span class="hs-operator">.</span><span class="hs-identifier">runRWST</span><span> </span><a href="#local-6989586621679061332"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679061329"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061330"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#distribute"><span class="hs-identifier hs-var">distribute</span></a><span> </span><a href="#local-6989586621679061331"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-270"></a><span class="hs-pragma">{-# INLINABLE runRWSP #-}</span><span>
</span><a name="line-271"></a><span>
</span><a name="line-272"></a><span class="hs-comment">-- | Evaluate 'RWS.RWST' in the base monad</span><span>
</span><a name="line-273"></a><span class="hs-identifier">evalRWSP</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061131"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061132"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061133"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-276"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061134"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-277"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061135"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061136"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061137"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061138"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679061133"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679061132"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061134"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061131"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061139"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-278"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061135"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061136"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061137"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061138"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061131"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061139"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061132"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><a name="evalRWSP"><a href="Pipes.Lift.html#evalRWSP"><span class="hs-identifier">evalRWSP</span></a></a><span> </span><a name="local-6989586621679061333"><a href="#local-6989586621679061333"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061334"><a href="#local-6989586621679061334"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061335"><a href="#local-6989586621679061335"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679061336"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#runRWSP"><span class="hs-identifier hs-var">runRWSP</span></a><span> </span><a href="#local-6989586621679061333"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061334"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061335"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-280"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-281"></a><span>    </span><a name="local-6989586621679061336"><a href="#local-6989586621679061336"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061337"><a href="#local-6989586621679061337"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679061338"><a href="#local-6989586621679061338"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679061339"><a href="#local-6989586621679061339"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061337"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061338"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061339"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span class="hs-pragma">{-# INLINABLE evalRWSP #-}</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span class="hs-comment">-- | Execute 'RWS.RWST' in the base monad</span><span>
</span><a name="line-285"></a><span class="hs-identifier">execRWSP</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679061122"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679061123"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679061124"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-288"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679061125"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-289"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061126"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061127"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061128"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061129"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">RWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679061124"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679061123"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679061125"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679061122"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679061130"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-290"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Pipes.Internal.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a><span> </span><a href="#local-6989586621679061126"><span class="hs-identifier hs-type">a'</span></a><span> </span><a href="#local-6989586621679061127"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679061128"><span class="hs-identifier hs-type">b'</span></a><span> </span><a href="#local-6989586621679061129"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679061122"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061125"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061123"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><a name="execRWSP"><a href="Pipes.Lift.html#execRWSP"><span class="hs-identifier">execRWSP</span></a></a><span> </span><a name="local-6989586621679061340"><a href="#local-6989586621679061340"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679061341"><a href="#local-6989586621679061341"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679061342"><a href="#local-6989586621679061342"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679061343"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Pipes.Lift.html#runRWSP"><span class="hs-identifier hs-var">runRWSP</span></a><span> </span><a href="#local-6989586621679061340"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679061341"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679061342"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-292"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-293"></a><span>    </span><a name="local-6989586621679061343"><a href="#local-6989586621679061343"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679061344"><a href="#local-6989586621679061344"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679061345"><a href="#local-6989586621679061345"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679061346"><a href="#local-6989586621679061346"><span class="hs-identifier">w</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679061344"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679061345"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679061346"><span class="hs-identifier hs-var">w</span></a><span class="hs-special">)</span><span>
</span><a name="line-294"></a><span class="hs-pragma">{-# INLINABLE execRWSP #-}</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">{- $tutorial
    Probably the most useful functionality in this module is lifted error
    handling.  Suppose that you have a 'Pipes.Pipe' whose base monad can fail
    using 'E.ExceptT':

&gt; import Control.Monad.Trans.Error
&gt; import Pipes
&gt;
&gt; example :: Monad m =&gt; Pipe Int Int (ExceptT String m) r
&gt; example = for cat $ \n -&gt;
&gt;     if n == 0
&gt;     then lift $ throwError &quot;Zero is forbidden&quot;
&gt;     else yield n

    Without the tools in this module you cannot recover from any potential error
    until after you compose and run the pipeline:

&gt;&gt;&gt; import qualified Pipes.Prelude as P
&gt;&gt;&gt; runExceptT $ runEffect $ P.readLn &gt;-&gt; example &gt;-&gt; P.print
42&lt;Enter&gt;
42
1&lt;Enter&gt;
1
0&lt;Enter&gt;
Zero is forbidden
&gt;&gt;&gt;

    This module provides `catchError`, which lets you catch and recover from
    errors inside the 'Pipe':

&gt;  import qualified Pipes.Lift as Lift
&gt; 
&gt;  caught :: Pipe Int Int (ExceptT String IO) r
&gt;  caught = example `Lift.catchError` \str -&gt; do
&gt;      liftIO (putStrLn str)
&gt;      caught

    This lets you resume streaming in the face of errors raised within the base
    monad:

&gt;&gt;&gt; runExceptT $ runEffect $ P.readLn &gt;-&gt; caught &gt;-&gt; P.print
0&lt;Enter&gt;
Zero is forbidden
42&lt;Enter&gt;
42
0&lt;Enter&gt;
Zero is forbidden
1&lt;Enter&gt;
1
...

    Another common use case is running a base monad before running the pipeline.
    For example, the following contrived 'Producer' uses 'S.StateT' gratuitously
    to increment numbers:

&gt; import Control.Monad (forever)
&gt; import Control.Monad.Trans.State.Strict
&gt; import Pipes
&gt; 
&gt; numbers :: Monad m =&gt; Producer Int (StateT Int m) r
&gt; numbers = forever $ do
&gt;     n &lt;- lift get
&gt;     yield n
&gt;     lift $ put $! n + 1

    You can run the 'StateT' monad by supplying an initial state, before you
    ever compose the 'Producer':

&gt; import Pipes.Lift
&gt;
&gt; naturals :: Monad m =&gt; Producer Int m r
&gt; naturals = evalStateP 0 numbers

    This deletes 'StateT' from the base monad entirely, give you a completely
    pure 'Pipes.Producer':

&gt;&gt;&gt; Pipes.Prelude.toList naturals
[0,1,2,3,4,5,6...]

    Note that the convention for the 'S.StateT' run functions is backwards from
    @transformers@ for convenience: the initial state is the first argument.

    All of these functions internally use 'distribute', which can pull out most
    monad transformers from the base monad.  For example, 'evalStateP' is
    defined in terms of 'distribute':

&gt; evalStateP s p = evalStateT (distribute p) s

    Therefore you can use 'distribute' to run other monad transformers, too, as
    long as they implement the 'MFunctor' type class from the @mmorph@ library.
-}</span><span>
</span><a name="line-387"></a></pre></body></html>