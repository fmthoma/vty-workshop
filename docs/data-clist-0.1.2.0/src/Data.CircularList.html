<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
A simple purely functional circular list, or ring, data type.

Lets describe what we mean by 'ring'. A ring is a circular data structure
such that if you continue rotating the ring, you'll eventually return to
the element you first observed.

All of our analogies involve sitting at a table who's top surface rotates
about its center axis (think of those convenient rotating platforms one
often finds in an (Americanized) Chinese Restaurant).

Only the closest item on the table is avialable to us. In order to reach
other elements on the table, we need to rotate the table to the left or
the right.

Our convention for this problem says that rotations to the right are a
forward motion while rotations to the left are backward motions.

We'll use the following circular list for our examples:

&gt;   8 7 6
&gt;  9     5
&gt; A       4
&gt; B       3
&gt;  C     2
&gt;   D 0 1
&gt;     ^

The pointer at the bottom represents our position at the table. The element
currently in front of is is referred to as the `focus`. So, in this case,
our focus is 0.

If we were to rotate the table to the right using the `rotR` operation, we'd
have the following table.

&gt;   9 8 7
&gt;  A     6
&gt; B       5
&gt; C       4
&gt;  D     3
&gt;   0 1 2
&gt;     ^

This yields 1 as our new focus. Rotating this table left would return 0 to
the focus position.

-}</span><span>
</span><a name="line-48"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">CircularList</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- * Data Types</span><span>
</span><a name="line-50"></a><span>    </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- * Functions</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-comment">-- ** Creation of CLists</span><span>
</span><a name="line-53"></a><span>    </span><a href="Data.CircularList.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- ** Update of CList</span><span>
</span><a name="line-55"></a><span>    </span><a href="Data.CircularList.html#update"><span class="hs-identifier hs-var">update</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier hs-var">reverseDirection</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- ** Converting CLists to Lists</span><span>
</span><a name="line-57"></a><span>    </span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#toInfList"><span class="hs-identifier hs-var">toInfList</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- ** Extraction and Accumulation</span><span>
</span><a name="line-59"></a><span>    </span><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-var">focus</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#insertL"><span class="hs-identifier hs-var">insertL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#insertR"><span class="hs-identifier hs-var">insertR</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>    </span><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-comment">-- ** Manipulation of Focus</span><span>
</span><a name="line-62"></a><span>    </span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rotNR"><span class="hs-identifier hs-var">rotNR</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#rotNL"><span class="hs-identifier hs-var">rotNL</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>    </span><a href="Data.CircularList.html#rotateTo"><span class="hs-identifier hs-var">rotateTo</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier hs-var">findRotateTo</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-comment">-- ** List-like functions</span><span>
</span><a name="line-65"></a><span>    </span><a href="Data.CircularList.html#filterR"><span class="hs-identifier hs-var">filterR</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#filterL"><span class="hs-identifier hs-var">filterL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#foldrR"><span class="hs-identifier hs-var">foldrR</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#foldrL"><span class="hs-identifier hs-var">foldrL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#foldlR"><span class="hs-identifier hs-var">foldlR</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#foldlL"><span class="hs-identifier hs-var">foldlL</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-comment">-- ** Manipulation of Packing</span><span>
</span><a name="line-67"></a><span>    </span><a href="Data.CircularList.html#balance"><span class="hs-identifier hs-var">balance</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#packL"><span class="hs-identifier hs-var">packL</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#packR"><span class="hs-identifier hs-var">packR</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-comment">-- ** Information</span><span>
</span><a name="line-69"></a><span>    </span><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a><span class="hs-special">,</span><span> </span><a href="Data.CircularList.html#size"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">empty</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-special">(</span><span class="hs-identifier hs-var">find</span><span class="hs-special">,</span><span class="hs-identifier hs-var">unfoldr</span><span class="hs-special">,</span><span class="hs-identifier hs-var">foldl'</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-special">(</span><span class="hs-identifier hs-var">join</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span class="hs-operator">.</span><span class="hs-identifier">Arbitrary</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Test</span><span class="hs-operator">.</span><span class="hs-identifier">QuickCheck</span><span class="hs-operator">.</span><span class="hs-identifier">Gen</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">-- | A functional ring type.</span><span>
</span><a name="line-85"></a><span class="hs-keyword">data</span><span> </span><a name="CList"><a href="Data.CircularList.html#CList"><span class="hs-identifier">CList</span></a></a><span> </span><a name="local-6989586621679031936"><a href="#local-6989586621679031936"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Empty"><a href="Data.CircularList.html#Empty"><span class="hs-identifier">Empty</span></a></a><span>
</span><a name="line-86"></a><span>             </span><span class="hs-glyph">|</span><span> </span><a name="CList"><a href="Data.CircularList.html#CList"><span class="hs-identifier">CList</span></a></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031936"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679031936"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031936"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">{- Creating CLists -}</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | An empty CList.</span><span>
</span><a name="line-91"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032421"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-92"></a><a name="empty"><a href="Data.CircularList.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- |Make a (balanced) CList from a list.</span><span>
</span><a name="line-95"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032420"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032420"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-96"></a><a name="fromList"><a href="Data.CircularList.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-97"></a><span class="hs-identifier">fromList</span><span> </span><a name="local-6989586621679032422"><a href="#local-6989586621679032422"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679032423"><a href="#local-6989586621679032423"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032424"><a href="#local-6989586621679032424"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032425"><a href="#local-6989586621679032425"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679032422"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-98"></a><span>                        </span><span class="hs-special">(</span><a name="local-6989586621679032426"><a href="#local-6989586621679032426"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032427"><a href="#local-6989586621679032427"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032425"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">div</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032424"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-99"></a><span>                    </span><span class="hs-keyword">in</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679032427"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032423"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679032426"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032419"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-102"></a><a name="singleton"><a href="Data.CircularList.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-6989586621679033170"><a href="#local-6989586621679033170"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033170"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-comment">{- Updating of CLists -}</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- |Replaces the current focus with a new focus.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">update</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032418"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-108"></a><a name="update"><a href="Data.CircularList.html#update"><span class="hs-identifier">update</span></a></a><span> </span><a name="local-6989586621679033171"><a href="#local-6989586621679033171"><span class="hs-identifier">v</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033171"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span class="hs-identifier">update</span><span> </span><a name="local-6989586621679033172"><a href="#local-6989586621679033172"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033173"><a href="#local-6989586621679033173"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033174"><a href="#local-6989586621679033174"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033173"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679033172"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679033174"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- |Reverse the direction of rotation.</span><span>
</span><a name="line-112"></a><span class="hs-identifier">reverseDirection</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032417"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032417"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-113"></a><a name="reverseDirection"><a href="Data.CircularList.html#reverseDirection"><span class="hs-identifier">reverseDirection</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-114"></a><span class="hs-identifier">reverseDirection</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033175"><a href="#local-6989586621679033175"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033176"><a href="#local-6989586621679033176"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033177"><a href="#local-6989586621679033177"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033177"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679033176"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033175"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{- Creating Lists -}</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- |Starting with the focus, go left and accumulate all</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- elements of the CList in a list.</span><span>
</span><a name="line-120"></a><span class="hs-identifier">leftElements</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032416"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032416"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-121"></a><a name="leftElements"><a href="Data.CircularList.html#leftElements"><span class="hs-identifier">leftElements</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-122"></a><span class="hs-identifier">leftElements</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033178"><a href="#local-6989586621679033178"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033179"><a href="#local-6989586621679033179"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033180"><a href="#local-6989586621679033180"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033179"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033178"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033180"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- |Starting with the focus, go right and accumulate all</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- elements of the CList in a list.</span><span>
</span><a name="line-126"></a><span class="hs-identifier">rightElements</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032415"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-127"></a><a name="rightElements"><a href="Data.CircularList.html#rightElements"><span class="hs-identifier">rightElements</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-128"></a><span class="hs-identifier">rightElements</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033181"><a href="#local-6989586621679033181"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033182"><a href="#local-6989586621679033182"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033183"><a href="#local-6989586621679033183"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033182"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033183"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033181"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- |Make a list from a CList.</span><span>
</span><a name="line-131"></a><span class="hs-identifier">toList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032414"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032414"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-132"></a><a name="toList"><a href="Data.CircularList.html#toList"><span class="hs-identifier">toList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- |Make a CList into an infinite list.</span><span>
</span><a name="line-135"></a><span class="hs-identifier">toInfList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032413"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032413"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-136"></a><a name="toInfList"><a href="Data.CircularList.html#toInfList"><span class="hs-identifier">toInfList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cycle</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">{- Extraction and Accumulation -}</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- |Return the focus of the CList.</span><span>
</span><a name="line-141"></a><span class="hs-identifier">focus</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032412"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679032412"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-142"></a><a name="focus"><a href="Data.CircularList.html#focus"><span class="hs-identifier">focus</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-143"></a><span class="hs-identifier">focus</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033184"><a href="#local-6989586621679033184"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679033184"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- |Insert an element into the CList as the new focus. The</span><span>
</span><a name="line-146"></a><span class="hs-comment">-- old focus is now the next element to the right.</span><span>
</span><a name="line-147"></a><span class="hs-identifier">insertR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032411"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032411"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032411"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-148"></a><a name="insertR"><a href="Data.CircularList.html#insertR"><span class="hs-identifier">insertR</span></a></a><span> </span><a name="local-6989586621679033185"><a href="#local-6989586621679033185"><span class="hs-identifier">i</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033185"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-149"></a><span class="hs-identifier">insertR</span><span> </span><a name="local-6989586621679033186"><a href="#local-6989586621679033186"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033187"><a href="#local-6989586621679033187"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033188"><a href="#local-6989586621679033188"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033189"><a href="#local-6989586621679033189"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033187"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679033186"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033188"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033189"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-comment">-- |Insert an element into the CList as the new focus. The</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- old focus is now the next element to the left.</span><span>
</span><a name="line-153"></a><span class="hs-identifier">insertL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679032410"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032410"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032410"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-154"></a><a name="insertL"><a href="Data.CircularList.html#insertL"><span class="hs-identifier">insertL</span></a></a><span> </span><a name="local-6989586621679033190"><a href="#local-6989586621679033190"><span class="hs-identifier">i</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033190"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span class="hs-identifier">insertL</span><span> </span><a name="local-6989586621679033191"><a href="#local-6989586621679033191"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033192"><a href="#local-6989586621679033192"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033193"><a href="#local-6989586621679033193"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033194"><a href="#local-6989586621679033194"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033193"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033192"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033191"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679033194"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- |Remove the focus from the CList. The new focus is the</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- next element to the left.</span><span>
</span><a name="line-159"></a><span class="hs-identifier">removeL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032409"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032409"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-160"></a><a name="removeL"><a href="Data.CircularList.html#removeL"><span class="hs-identifier">removeL</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-161"></a><span class="hs-identifier">removeL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-162"></a><span class="hs-identifier">removeL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033195"><a href="#local-6989586621679033195"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033196"><a href="#local-6989586621679033196"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033197"><a href="#local-6989586621679033197"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033196"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033195"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679033197"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-163"></a><span class="hs-identifier">removeL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033198"><a href="#local-6989586621679033198"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033199"><a href="#local-6989586621679033199"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033200"><a href="#local-6989586621679033200"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033198"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-164"></a><span>                          </span><span class="hs-keyword">in</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033200"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033199"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- |Remove the focus from the CList.</span><span>
</span><a name="line-167"></a><span class="hs-identifier">removeR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032408"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032408"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-168"></a><a name="removeR"><a href="Data.CircularList.html#removeR"><span class="hs-identifier">removeR</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-169"></a><span class="hs-identifier">removeR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-170"></a><span class="hs-identifier">removeR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033201"><a href="#local-6989586621679033201"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033202"><a href="#local-6989586621679033202"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033203"><a href="#local-6989586621679033203"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033201"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679033202"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679033203"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-171"></a><span class="hs-identifier">removeR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033204"><a href="#local-6989586621679033204"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033205"><a href="#local-6989586621679033205"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033206"><a href="#local-6989586621679033206"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033204"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-172"></a><span>                         </span><span class="hs-keyword">in</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033205"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033206"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">{- Manipulating Rotation -}</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- |Return all possible rotations of the provided 'CList', where the</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- focus is the provided 'CList'.</span><span>
</span><a name="line-178"></a><span class="hs-identifier">allRotations</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032407"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032407"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><a name="allRotations"><a href="Data.CircularList.html#allRotations"><span class="hs-identifier">allRotations</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-180"></a><span class="hs-identifier">allRotations</span><span> </span><a name="local-6989586621679033207"><a href="#local-6989586621679033207"><span class="hs-identifier">cl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033208"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033207"><span class="hs-identifier hs-var">cl</span></a><span> </span><a href="#local-6989586621679033209"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-181"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-182"></a><span>    </span><a name="local-6989586621679033208"><a href="#local-6989586621679033208"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unfoldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#mRotL"><span class="hs-identifier hs-var">mRotL</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033207"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-183"></a><span>    </span><a name="local-6989586621679033209"><a href="#local-6989586621679033209"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unfoldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#mRotR"><span class="hs-identifier hs-var">mRotR</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033207"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- |Rotate the focus to the previous (left) element.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">rotL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032406"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032406"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-187"></a><a name="rotL"><a href="Data.CircularList.html#rotL"><span class="hs-identifier">rotL</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-188"></a><span class="hs-identifier">rotL</span><span> </span><a name="local-6989586621679033342"><a href="#local-6989586621679033342"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033342"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-189"></a><span class="hs-identifier">rotL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033343"><a href="#local-6989586621679033343"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033344"><a href="#local-6989586621679033344"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679033345"><a href="#local-6989586621679033345"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033346"><a href="#local-6989586621679033346"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033344"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033343"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033345"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033346"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span class="hs-identifier">rotL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679033347"><a href="#local-6989586621679033347"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033348"><a href="#local-6989586621679033348"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033349"><a href="#local-6989586621679033349"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033350"><a href="#local-6989586621679033350"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033348"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-191"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033350"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033349"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679033347"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- |A non-cyclic version of 'rotL'; that is, only rotate the focus if</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- there is a previous (left) element to rotate to.</span><span>
</span><a name="line-195"></a><span class="hs-identifier">mRotL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032405"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032405"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-196"></a><a name="mRotL"><a href="Data.CircularList.html#mRotL"><span class="hs-identifier">mRotL</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033351"><a href="#local-6989586621679033351"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033352"><a href="#local-6989586621679033352"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679033353"><a href="#local-6989586621679033353"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033354"><a href="#local-6989586621679033354"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033352"><span class="hs-identifier hs-var">ls</span></a><span> </span><a href="#local-6989586621679033351"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033353"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033354"><span class="hs-identifier hs-var">rs</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span class="hs-identifier">mRotL</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- |Rotate the focus to the next (right) element.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">rotR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032404"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032404"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-201"></a><a name="rotR"><a href="Data.CircularList.html#rotR"><span class="hs-identifier">rotR</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-202"></a><span class="hs-identifier">rotR</span><span> </span><a name="local-6989586621679033355"><a href="#local-6989586621679033355"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033355"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-203"></a><span class="hs-identifier">rotR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033356"><a href="#local-6989586621679033356"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679033357"><a href="#local-6989586621679033357"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033358"><a href="#local-6989586621679033358"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033359"><a href="#local-6989586621679033359"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033357"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033356"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033358"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679033359"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-204"></a><span class="hs-identifier">rotR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033360"><a href="#local-6989586621679033360"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679033361"><a href="#local-6989586621679033361"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679033362"><a href="#local-6989586621679033362"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033363"><a href="#local-6989586621679033363"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033360"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-205"></a><span>                       </span><span class="hs-keyword">in</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679033361"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033362"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679033363"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- |A non-cyclic version of 'rotL'; that is, only rotate the focus if</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- there is a previous (left) element to rotate to.</span><span>
</span><a name="line-209"></a><span class="hs-identifier">mRotR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032403"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032403"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="mRotR"><a href="Data.CircularList.html#mRotR"><span class="hs-identifier">mRotR</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033364"><a href="#local-6989586621679033364"><span class="hs-identifier">ls</span></a></a><span> </span><a name="local-6989586621679033365"><a href="#local-6989586621679033365"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679033366"><a href="#local-6989586621679033366"><span class="hs-identifier">r</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679033367"><a href="#local-6989586621679033367"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033365"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679033364"><span class="hs-identifier hs-var">ls</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033366"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679033367"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-211"></a><span class="hs-identifier">mRotR</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- |Rotate the focus the specified number of times; if the index is</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- positive then it is rotated to the right; otherwise it is rotated</span><span>
</span><a name="line-215"></a><span class="hs-comment">-- to the left.</span><span>
</span><a name="line-216"></a><span class="hs-identifier">rotN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032402"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032402"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-217"></a><a name="rotN"><a href="Data.CircularList.html#rotN"><span class="hs-identifier">rotN</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-218"></a><span class="hs-identifier">rotN</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033368"><a href="#local-6989586621679033368"><span class="hs-identifier">cl</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033368"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-219"></a><span class="hs-identifier">rotN</span><span> </span><a name="local-6989586621679033369"><a href="#local-6989586621679033369"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679033370"><a href="#local-6989586621679033370"><span class="hs-identifier">cl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">iterate</span><span> </span><a href="#local-6989586621679033372"><span class="hs-identifier hs-var">rot</span></a><span> </span><a href="#local-6989586621679033370"><span class="hs-identifier hs-var">cl</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679033371"><span class="hs-identifier hs-var">n'</span></a><span>
</span><a name="line-220"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-221"></a><span>    </span><a name="local-6989586621679033371"><a href="#local-6989586621679033371"><span class="hs-identifier">n'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679033369"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-222"></a><span>    </span><a name="local-6989586621679033372"><a href="#local-6989586621679033372"><span class="hs-identifier">rot</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033369"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#rotL"><span class="hs-identifier hs-var">rotL</span></a><span>
</span><a name="line-223"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#rotR"><span class="hs-identifier hs-var">rotR</span></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- |A wrapper around 'rotN' that doesn't rotate the CList if @n &lt;= 0@.</span><span>
</span><a name="line-226"></a><span class="hs-identifier">rotNR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032401"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032401"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-227"></a><a name="rotNR"><a href="Data.CircularList.html#rotNR"><span class="hs-identifier">rotNR</span></a></a><span> </span><a name="local-6989586621679033437"><a href="#local-6989586621679033437"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679033438"><a href="#local-6989586621679033438"><span class="hs-identifier">cl</span></a></a><span>
</span><a name="line-228"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033437"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033438"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-229"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a><span> </span><a href="#local-6989586621679033437"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679033438"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- |Rotate the focus the specified number of times to the left (but</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- don't rotate if @n &lt;= 0@).</span><span>
</span><a name="line-233"></a><span class="hs-identifier">rotNL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032400"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032400"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-234"></a><a name="rotNL"><a href="Data.CircularList.html#rotNL"><span class="hs-identifier">rotNL</span></a></a><span> </span><a name="local-6989586621679033439"><a href="#local-6989586621679033439"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679033440"><a href="#local-6989586621679033440"><span class="hs-identifier">cl</span></a></a><span>
</span><a name="line-235"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033439"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033440"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-236"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#rotN"><span class="hs-identifier hs-var">rotN</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">negate</span><span> </span><a href="#local-6989586621679033439"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033440"><span class="hs-identifier hs-var">cl</span></a><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- |Rotate the 'CList' such that the specified element (if it exists)</span><span>
</span><a name="line-239"></a><span class="hs-comment">-- is focused.</span><span>
</span><a name="line-240"></a><span class="hs-identifier">rotateTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679032399"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679032399"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032399"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032399"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><a name="rotateTo"><a href="Data.CircularList.html#rotateTo"><span class="hs-identifier">rotateTo</span></a></a><span> </span><a name="local-6989586621679033441"><a href="#local-6989586621679033441"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier hs-var">findRotateTo</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033441"><span class="hs-identifier hs-var">a</span></a><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- |Attempt to rotate the 'CList' such that focused element matches</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- the supplied predicate.</span><span>
</span><a name="line-245"></a><span class="hs-identifier">findRotateTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032398"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032398"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032398"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><a name="findRotateTo"><a href="Data.CircularList.html#findRotateTo"><span class="hs-identifier">findRotateTo</span></a></a><span> </span><a name="local-6989586621679033442"><a href="#local-6989586621679033442"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><a href="#local-6989586621679033442"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#focus"><span class="hs-identifier hs-var">focus</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-comment">{- List-like functions -}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">-- |Remove those elements that do not satisfy the supplied predicate,</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- rotating to the right if the focus does not satisfy the predicate.</span><span>
</span><a name="line-252"></a><span class="hs-identifier">filterR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032397"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032397"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032397"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-253"></a><a name="filterR"><a href="Data.CircularList.html#filterR"><span class="hs-identifier">filterR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var">filterCL</span></a><span> </span><a href="Data.CircularList.html#removeR"><span class="hs-identifier hs-var">removeR</span></a><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- |As with 'filterR', but rotates to the /left/ if the focus does not</span><span>
</span><a name="line-256"></a><span class="hs-comment">-- satisfy the predicate.</span><span>
</span><a name="line-257"></a><span class="hs-identifier">filterL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032396"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032396"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032396"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-258"></a><a name="filterL"><a href="Data.CircularList.html#filterL"><span class="hs-identifier">filterL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#filterCL"><span class="hs-identifier hs-var">filterCL</span></a><span> </span><a href="Data.CircularList.html#removeL"><span class="hs-identifier hs-var">removeL</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- |Abstract away what to do with the focused element if it doesn't</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- match the predicate when filtering.</span><span>
</span><a name="line-262"></a><span class="hs-identifier">filterCL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032395"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-263"></a><a name="filterCL"><a href="Data.CircularList.html#filterCL"><span class="hs-identifier">filterCL</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-264"></a><span class="hs-identifier">filterCL</span><span> </span><a name="local-6989586621679033464"><a href="#local-6989586621679033464"><span class="hs-identifier">rm</span></a></a><span> </span><a name="local-6989586621679033465"><a href="#local-6989586621679033465"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033466"><a href="#local-6989586621679033466"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033467"><a href="#local-6989586621679033467"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033468"><a href="#local-6989586621679033468"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679033465"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679033467"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">cl'</span></a><span>
</span><a name="line-266"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679033464"><span class="hs-identifier hs-var">rm</span></a><span> </span><a href="#local-6989586621679033469"><span class="hs-identifier hs-var">cl'</span></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-268"></a><span>    </span><a name="local-6989586621679033469"><a href="#local-6989586621679033469"><span class="hs-identifier">cl'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679033465"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679033466"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033467"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><a href="#local-6989586621679033465"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679033468"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- |A right-fold, rotating to the right through the CList.</span><span>
</span><a name="line-271"></a><span class="hs-identifier">foldrR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032393"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032393"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032394"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-272"></a><a name="foldrR"><a href="Data.CircularList.html#foldrR"><span class="hs-identifier">foldrR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-var">foldrCL</span></a><span> </span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- |A right-fold, rotating to the left through the CList.</span><span>
</span><a name="line-275"></a><span class="hs-identifier">foldrL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032391"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032391"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032392"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-276"></a><a name="foldrL"><a href="Data.CircularList.html#foldrL"><span class="hs-identifier">foldrL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier hs-var">foldrCL</span></a><span> </span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-comment">-- |Abstract away direction for a foldr.</span><span>
</span><a name="line-279"></a><span class="hs-identifier">foldrCL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032389"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032390"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-280"></a><a name="foldrCL"><a href="Data.CircularList.html#foldrCL"><span class="hs-identifier">foldrCL</span></a></a><span> </span><a name="local-6989586621679033470"><a href="#local-6989586621679033470"><span class="hs-identifier">toL</span></a></a><span> </span><a name="local-6989586621679033471"><a href="#local-6989586621679033471"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033472"><a href="#local-6989586621679033472"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679033471"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033472"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679033470"><span class="hs-identifier hs-var">toL</span></a><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- |A (strict) left-fold, rotating to the right through the CList.</span><span>
</span><a name="line-283"></a><span class="hs-identifier">foldlR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032388"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032387"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-284"></a><a name="foldlR"><a href="Data.CircularList.html#foldlR"><span class="hs-identifier">foldlR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-var">foldlCL</span></a><span> </span><a href="Data.CircularList.html#rightElements"><span class="hs-identifier hs-var">rightElements</span></a><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-comment">-- |A (strict) left-fold, rotating to the left through the CList.</span><span>
</span><a name="line-287"></a><span class="hs-identifier">foldlL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032385"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032386"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032385"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032385"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032386"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032385"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-288"></a><a name="foldlL"><a href="Data.CircularList.html#foldlL"><span class="hs-identifier">foldlL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier hs-var">foldlCL</span></a><span> </span><a href="Data.CircularList.html#leftElements"><span class="hs-identifier hs-var">leftElements</span></a><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- |Abstract away direction for a foldl'.</span><span>
</span><a name="line-291"></a><span class="hs-identifier">foldlCL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032383"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032383"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032384"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032383"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032384"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032384"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032383"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679032384"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-292"></a><a name="foldlCL"><a href="Data.CircularList.html#foldlCL"><span class="hs-identifier">foldlCL</span></a></a><span> </span><a name="local-6989586621679033473"><a href="#local-6989586621679033473"><span class="hs-identifier">toL</span></a></a><span> </span><a name="local-6989586621679033474"><a href="#local-6989586621679033474"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033475"><a href="#local-6989586621679033475"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl'</span><span> </span><a href="#local-6989586621679033474"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033475"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679033473"><span class="hs-identifier hs-var">toL</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-comment">{- Manipulating Packing -}</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- |Balance the CList. Equivalent to `fromList . toList`</span><span>
</span><a name="line-297"></a><span class="hs-identifier">balance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032382"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032382"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-298"></a><a name="balance"><a href="Data.CircularList.html#balance"><span class="hs-identifier">balance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-comment">-- |Move all elements to the left side of the CList.</span><span>
</span><a name="line-301"></a><span class="hs-identifier">packL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032381"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032381"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-302"></a><a name="packL"><a href="Data.CircularList.html#packL"><span class="hs-identifier">packL</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-303"></a><span class="hs-identifier">packL</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033476"><a href="#local-6989586621679033476"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033477"><a href="#local-6989586621679033477"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033478"><a href="#local-6989586621679033478"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033476"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033478"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679033477"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-comment">-- |Move all elements to the right side of the CList.</span><span>
</span><a name="line-306"></a><span class="hs-identifier">packR</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032380"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032380"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-307"></a><a name="packR"><a href="Data.CircularList.html#packR"><span class="hs-identifier">packR</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-308"></a><span class="hs-identifier">packR</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033479"><a href="#local-6989586621679033479"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033480"><a href="#local-6989586621679033480"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033481"><a href="#local-6989586621679033481"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679033480"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033481"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679033479"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">{- Information -}</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">-- |Returns true if the CList is empty.</span><span>
</span><a name="line-313"></a><span class="hs-identifier">isEmpty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679032379"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-314"></a><a name="isEmpty"><a href="Data.CircularList.html#isEmpty"><span class="hs-identifier">isEmpty</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-315"></a><span class="hs-identifier">isEmpty</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">-- |Return the size of the CList.</span><span>
</span><a name="line-318"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679031937"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-319"></a><a name="size"><a href="Data.CircularList.html#size"><span class="hs-identifier">size</span></a></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-320"></a><span class="hs-identifier">size</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033482"><a href="#local-6989586621679033482"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679033483"><a href="#local-6989586621679033483"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033482"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679033483"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">{- Instances -}</span><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679033550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679033550"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-325"></a><span> </span><a name="local-8214565720323791410"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679033551"><a href="#local-6989586621679033551"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679033552"><a href="#local-6989586621679033552"><span class="hs-identifier">cl</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033551"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-326"></a><span>                   </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;fromList &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679033552"><span class="hs-identifier hs-var">cl</span></a><span class="hs-special">)</span><span>
</span><a name="line-327"></a><span>
</span><a name="line-328"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679033522"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679033522"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span> </span><a name="local-8214565720323791124"><span class="hs-identifier">readsPrec</span></a><span> </span><a name="local-6989586621679033523"><a href="#local-6989586621679033523"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readParen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033523"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679033524"><a href="#local-6989586621679033524"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-330"></a><span>   </span><span class="hs-special">(</span><span class="hs-string">&quot;fromList&quot;</span><span class="hs-special">,</span><a name="local-6989586621679033525"><a href="#local-6989586621679033525"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lex</span><span> </span><a href="#local-6989586621679033524"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-331"></a><span>   </span><span class="hs-special">(</span><a name="local-6989586621679033548"><a href="#local-6989586621679033548"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679033549"><a href="#local-6989586621679033549"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">reads</span><span> </span><a href="#local-6989586621679033525"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-332"></a><span>   </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span> </span><a href="#local-6989586621679033548"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><a href="#local-6989586621679033549"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679033519"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679033519"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-335"></a><span>  </span><a name="local-6989586621679033520"><a href="#local-6989586621679033520"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a name="local-6989586621679033521"><a href="#local-6989586621679033521"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-6989586621679033520"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.CircularList.html#toList"><span class="hs-identifier hs-var">toList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.CircularList.html#allRotations"><span class="hs-identifier hs-var">allRotations</span></a><span> </span><a href="#local-6989586621679033521"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-6989586621679033515"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679033515"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-338"></a><span>  </span><a name="local-8214565720323792643"><span class="hs-identifier">rnf</span></a><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>  </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033516"><a href="#local-6989586621679033516"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033517"><a href="#local-6989586621679033517"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033518"><a href="#local-6989586621679033518"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621679033517"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-340"></a><span>                      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621679033516"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-341"></a><span>                      </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-6989586621679033518"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-342"></a><span>
</span><a name="line-343"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><a href="#local-6989586621679033504"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Arbitrary</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><a href="#local-6989586621679033504"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-344"></a><span>    </span><a name="local-8214565720323785297"><span class="hs-identifier">arbitrary</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">frequency</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">10</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679033505"><span class="hs-identifier hs-var">arbCList</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-345"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679033505"><a href="#local-6989586621679033505"><span class="hs-identifier">arbCList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-346"></a><span>                </span><a name="local-6989586621679033506"><a href="#local-6989586621679033506"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-347"></a><span>                </span><a name="local-6989586621679033507"><a href="#local-6989586621679033507"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-348"></a><span>                </span><a name="local-6989586621679033508"><a href="#local-6989586621679033508"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">arbitrary</span><span>
</span><a name="line-349"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033506"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679033507"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679033508"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-350"></a><span>    </span><a name="local-8214565720323785296"><span class="hs-identifier">shrink</span></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033509"><a href="#local-6989586621679033509"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033510"><a href="#local-6989586621679033510"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033511"><a href="#local-6989586621679033511"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033512"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-6989586621679033513"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621679033514"><span class="hs-identifier hs-var">r'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679033512"><a href="#local-6989586621679033512"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">shrink</span><span> </span><a href="#local-6989586621679033509"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span>
</span><a name="line-351"></a><span>                                                      </span><a name="local-6989586621679033513"><a href="#local-6989586621679033513"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">shrink</span><span> </span><a href="#local-6989586621679033510"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span>
</span><a name="line-352"></a><span>                                                      </span><a name="local-6989586621679033514"><a href="#local-6989586621679033514"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">shrink</span><span> </span><a href="#local-6989586621679033511"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">]</span><span>
</span><a name="line-353"></a><span>    </span><span class="hs-identifier">shrink</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-356"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-357"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a name="local-6989586621679033500"><a href="#local-6989586621679033500"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033501"><a href="#local-6989586621679033501"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033502"><a href="#local-6989586621679033502"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033503"><a href="#local-6989586621679033503"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679033500"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679033501"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679033500"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679033502"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679033500"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679033503"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-358"></a><span>
</span><a name="line-359"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">F</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-360"></a><span>  </span><a name="local-8214565720323790441"><span class="hs-identifier">foldMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldMapDefault</span><span>
</span><a name="line-361"></a><span>
</span><a name="line-362"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">T</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-type">CList</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-363"></a><span>  </span><span class="hs-comment">-- | traverses the list from left to right, starting at the focus</span><span>
</span><a name="line-364"></a><span>  </span><a name="local-8214565720323788863"><span class="hs-identifier">traverse</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="Data.CircularList.html#Empty"><span class="hs-identifier hs-var">Empty</span></a><span>
</span><a name="line-365"></a><span>  </span><span class="hs-identifier">traverse</span><span> </span><a name="local-6989586621679033484"><a href="#local-6989586621679033484"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a name="local-6989586621679033485"><a href="#local-6989586621679033485"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679033486"><a href="#local-6989586621679033486"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679033487"><a href="#local-6989586621679033487"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679033488"><a href="#local-6989586621679033488"><span class="hs-identifier">f'</span></a></a><span> </span><a name="local-6989586621679033489"><a href="#local-6989586621679033489"><span class="hs-identifier">r'</span></a></a><span> </span><a name="local-6989586621679033490"><a href="#local-6989586621679033490"><span class="hs-identifier">l'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.CircularList.html#CList"><span class="hs-identifier hs-var">CList</span></a><span> </span><a href="#local-6989586621679033490"><span class="hs-identifier hs-var">l'</span></a><span> </span><a href="#local-6989586621679033488"><span class="hs-identifier hs-var">f'</span></a><span> </span><a href="#local-6989586621679033489"><span class="hs-identifier hs-var">r'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679033484"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679033486"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-366"></a><span>                                                           </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="#local-6989586621679033484"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679033487"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-367"></a><span>                                                           </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="#local-6989586621679033484"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679033485"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-368"></a></pre></body></html>