<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK hide #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">Vty</span><span class="hs-operator">.</span><span class="hs-identifier">Image</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.Vty.Attributes.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">Vty</span><span class="hs-operator">.</span><span class="hs-identifier">Attributes</span></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Graphics.Text.Width.html"><span class="hs-identifier">Graphics</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Width</span></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TL</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- | A display text is a Data.Text.Lazy</span><span>
</span><a name="line-17"></a><span class="hs-keyword">type</span><span> </span><a name="DisplayText"><a href="Graphics.Vty.Image.Internal.html#DisplayText"><span class="hs-identifier">DisplayText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-identifier">clipText</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#DisplayText"><span class="hs-identifier hs-type">DisplayText</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.Vty.Image.Internal.html#DisplayText"><span class="hs-identifier hs-type">DisplayText</span></a><span>
</span><a name="line-20"></a><a name="clipText"><a href="Graphics.Vty.Image.Internal.html#clipText"><span class="hs-identifier">clipText</span></a></a><span> </span><a name="local-6989586621679343168"><a href="#local-6989586621679343168"><span class="hs-identifier">txt</span></a></a><span> </span><a name="local-6989586621679343169"><a href="#local-6989586621679343169"><span class="hs-identifier">leftSkip</span></a></a><span> </span><a name="local-6989586621679343170"><a href="#local-6989586621679343170"><span class="hs-identifier">rightClip</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-comment">-- CPS would clarify this I think</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679343171"><a href="#local-6989586621679343171"><span class="hs-identifier">toDrop</span></a></a><span class="hs-special">,</span><a name="local-6989586621679343172"><a href="#local-6989586621679343172"><span class="hs-identifier">padPrefix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343177"><span class="hs-identifier hs-var">clipForCharWidth</span></a><span> </span><a href="#local-6989586621679343169"><span class="hs-identifier hs-var">leftSkip</span></a><span> </span><a href="#local-6989586621679343168"><span class="hs-identifier hs-var">txt</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-23"></a><span>        </span><a name="local-6989586621679343173"><a href="#local-6989586621679343173"><span class="hs-identifier">txt'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679343172"><span class="hs-identifier hs-var">padPrefix</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">cons</span><span> </span><span class="hs-char">'&#8230;'</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343171"><span class="hs-identifier hs-var">toDrop</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343168"><span class="hs-identifier hs-var">txt</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span><span> </span><a href="#local-6989586621679343171"><span class="hs-identifier hs-var">toDrop</span></a><span> </span><a href="#local-6989586621679343168"><span class="hs-identifier hs-var">txt</span></a><span>
</span><a name="line-24"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679343174"><a href="#local-6989586621679343174"><span class="hs-identifier">toTake</span></a></a><span class="hs-special">,</span><a name="local-6989586621679343175"><a href="#local-6989586621679343175"><span class="hs-identifier">padSuffix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343177"><span class="hs-identifier hs-var">clipForCharWidth</span></a><span> </span><a href="#local-6989586621679343170"><span class="hs-identifier hs-var">rightClip</span></a><span> </span><a href="#local-6989586621679343173"><span class="hs-identifier hs-var">txt'</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-25"></a><span>        </span><a name="local-6989586621679343176"><a href="#local-6989586621679343176"><span class="hs-identifier">txt''</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">append</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679343174"><span class="hs-identifier hs-var">toTake</span></a><span> </span><a href="#local-6989586621679343173"><span class="hs-identifier hs-var">txt'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679343175"><span class="hs-identifier hs-var">padSuffix</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><span class="hs-char">'&#8230;'</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">-- Note: some characters and zero-width and combining characters</span><span>
</span><a name="line-27"></a><span>        </span><span class="hs-comment">-- combine to the left, so keep taking characters even if the</span><span>
</span><a name="line-28"></a><span>        </span><span class="hs-comment">-- width is zero.</span><span>
</span><a name="line-29"></a><span>        </span><a name="local-6989586621679343177"><a href="#local-6989586621679343177"><span class="hs-identifier">clipForCharWidth</span></a></a><span> </span><a name="local-6989586621679343178"><a href="#local-6989586621679343178"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343179"><a href="#local-6989586621679343179"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679343180"><a href="#local-6989586621679343180"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-30"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343180"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343178"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679343181"><span class="hs-identifier hs-var">cw</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343180"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679343178"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343177"><span class="hs-identifier hs-var">clipForCharWidth</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343178"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679343181"><span class="hs-identifier hs-var">cw</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343180"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>            </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679343181"><a href="#local-6989586621679343181"><span class="hs-identifier">cw</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Text.Width.html#safeWcwidth"><span class="hs-identifier hs-var">safeWcwidth</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679343179"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679343176"><span class="hs-identifier hs-var">txt''</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">-- | This is the internal representation of Images. Use the constructors</span><span>
</span><a name="line-37"></a><span class="hs-comment">-- in &quot;Graphics.Vty.Image&quot; to create instances.</span><span>
</span><a name="line-38"></a><span class="hs-comment">--</span><span>
</span><a name="line-39"></a><span class="hs-comment">-- Images are:</span><span>
</span><a name="line-40"></a><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- * a horizontal span of text</span><span>
</span><a name="line-42"></a><span class="hs-comment">--</span><span>
</span><a name="line-43"></a><span class="hs-comment">-- * a horizontal or vertical join of two images</span><span>
</span><a name="line-44"></a><span class="hs-comment">--</span><span>
</span><a name="line-45"></a><span class="hs-comment">-- * a two dimensional fill of the 'Picture's background character</span><span>
</span><a name="line-46"></a><span class="hs-comment">--</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- * a cropped image</span><span>
</span><a name="line-48"></a><span class="hs-comment">--</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- * an empty image of no size or content.</span><span>
</span><a name="line-50"></a><span class="hs-keyword">data</span><span> </span><a name="Image"><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier">Image</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- | A horizontal text span has a row height of 1.</span><span>
</span><a name="line-52"></a><span>      </span><a name="HorizText"><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier">HorizText</span></a></a><span>
</span><a name="line-53"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="attr"><a href="Graphics.Vty.Image.Internal.html#attr"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Attributes.html#Attr"><span class="hs-identifier hs-type">Attr</span></a><span>
</span><a name="line-54"></a><span>      </span><span class="hs-comment">-- | The text to display. The display width of the text is always</span><span>
</span><a name="line-55"></a><span>      </span><span class="hs-comment">-- outputWidth.</span><span>
</span><a name="line-56"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="displayText"><a href="Graphics.Vty.Image.Internal.html#displayText"><span class="hs-identifier">displayText</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#DisplayText"><span class="hs-identifier hs-type">DisplayText</span></a><span>
</span><a name="line-57"></a><span>      </span><span class="hs-comment">-- | The number of display columns for the text.</span><span>
</span><a name="line-58"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-59"></a><span>      </span><span class="hs-comment">-- | the number of characters in the text.</span><span>
</span><a name="line-60"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="charWidth"><a href="Graphics.Vty.Image.Internal.html#charWidth"><span class="hs-identifier">charWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-61"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-comment">-- | A horizontal join can be constructed between any two images.</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-comment">-- However a HorizJoin instance is required to be between two images</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-comment">-- of equal height. The horizJoin constructor adds background fills</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- to the provided images that assure this is true for the HorizJoin</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-comment">-- value produced.</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="HorizJoin"><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier">HorizJoin</span></a></a><span>
</span><a name="line-68"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="partLeft"><a href="Graphics.Vty.Image.Internal.html#partLeft"><span class="hs-identifier">partLeft</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-69"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="partRight"><a href="Graphics.Vty.Image.Internal.html#partRight"><span class="hs-identifier">partRight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-70"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-71"></a><span>      </span><span class="hs-comment">-- ^ imageWidth partLeft == imageWidth partRight. Always &gt; 0</span><span>
</span><a name="line-72"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-73"></a><span>      </span><span class="hs-comment">-- ^ imageHeight partLeft == imageHeight partRight. Always &gt; 0</span><span>
</span><a name="line-74"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-comment">-- | A veritical join can be constructed between any two images.</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-comment">-- However a VertJoin instance is required to be between two images</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-comment">-- of equal width. The vertJoin constructor adds background fills</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-comment">-- to the provides images that assure this is true for the VertJoin</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-comment">-- value produced.</span><span>
</span><a name="line-80"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="VertJoin"><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier">VertJoin</span></a></a><span>
</span><a name="line-81"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="partTop"><a href="Graphics.Vty.Image.Internal.html#partTop"><span class="hs-identifier">partTop</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-82"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="partBottom"><a href="Graphics.Vty.Image.Internal.html#partBottom"><span class="hs-identifier">partBottom</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-83"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-84"></a><span>      </span><span class="hs-comment">-- ^ imageWidth partTop == imageWidth partBottom. always &gt; 0</span><span>
</span><a name="line-85"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-86"></a><span>      </span><span class="hs-comment">-- ^ imageHeight partTop == imageHeight partBottom. always &gt; 1</span><span>
</span><a name="line-87"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-comment">-- | A background fill will be filled with the background char. The</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-comment">-- background char is defined as a property of the Picture this</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-comment">-- Image is used to form.</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="BGFill"><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier">BGFill</span></a></a><span>
</span><a name="line-92"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ always &gt; 0</span><span>
</span><a name="line-93"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ always &gt; 0</span><span>
</span><a name="line-94"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-comment">-- | Crop an image horizontally to a size by reducing the size from</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-comment">-- the right.</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="CropRight"><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier">CropRight</span></a></a><span>
</span><a name="line-98"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="croppedImage"><a href="Graphics.Vty.Image.Internal.html#croppedImage"><span class="hs-identifier">croppedImage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-99"></a><span>      </span><span class="hs-comment">-- | Always &lt; imageWidth croppedImage &gt; 0</span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-101"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-comment">-- ^ imageHeight croppedImage</span><span>
</span><a name="line-102"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-comment">-- | Crop an image horizontally to a size by reducing the size from</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-comment">-- the left.</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="CropLeft"><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier">CropLeft</span></a></a><span>
</span><a name="line-106"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="croppedImage"><a href="Graphics.Vty.Image.Internal.html#croppedImage"><span class="hs-identifier">croppedImage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-107"></a><span>      </span><span class="hs-comment">-- | Always &lt; imageWidth croppedImage &gt; 0</span><span>
</span><a name="line-108"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="leftSkip"><a href="Graphics.Vty.Image.Internal.html#leftSkip"><span class="hs-identifier">leftSkip</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-109"></a><span>      </span><span class="hs-comment">-- | Always &lt; imageWidth croppedImage &gt; 0</span><span>
</span><a name="line-110"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-111"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-112"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-comment">-- | Crop an image vertically to a size by reducing the size from</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-comment">-- the bottom</span><span>
</span><a name="line-115"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="CropBottom"><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier">CropBottom</span></a></a><span>
</span><a name="line-116"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="croppedImage"><a href="Graphics.Vty.Image.Internal.html#croppedImage"><span class="hs-identifier">croppedImage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-117"></a><span>      </span><span class="hs-comment">-- | imageWidth croppedImage</span><span>
</span><a name="line-118"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-119"></a><span>      </span><span class="hs-comment">-- | height image is cropped to. Always &lt; imageHeight croppedImage &gt; 0</span><span>
</span><a name="line-120"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-121"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-comment">-- | Crop an image vertically to a size by reducing the size from</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-comment">-- the top</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="CropTop"><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier">CropTop</span></a></a><span>
</span><a name="line-125"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="croppedImage"><a href="Graphics.Vty.Image.Internal.html#croppedImage"><span class="hs-identifier">croppedImage</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-126"></a><span>      </span><span class="hs-comment">-- | Always &lt; imageHeight croppedImage &gt; 0</span><span>
</span><a name="line-127"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="topSkip"><a href="Graphics.Vty.Image.Internal.html#topSkip"><span class="hs-identifier">topSkip</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-128"></a><span>      </span><span class="hs-comment">-- | imageWidth croppedImage</span><span>
</span><a name="line-129"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputWidth"><a href="Graphics.Vty.Image.Internal.html#outputWidth"><span class="hs-identifier">outputWidth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-130"></a><span>      </span><span class="hs-comment">-- | Always &lt; imageHeight croppedImage &gt; 0</span><span>
</span><a name="line-131"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="outputHeight"><a href="Graphics.Vty.Image.Internal.html#outputHeight"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-132"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-comment">-- | The empty image</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-comment">-- The combining operators identity constant.</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-comment">-- EmptyImage &lt;|&gt; a = a</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-comment">-- EmptyImage &lt;-&gt; a = a</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-comment">-- Any image of zero size equals the empty image.</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="EmptyImage"><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier">EmptyImage</span></a></a><span>
</span><a name="line-141"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>    </span><a name="local-8214565720323790720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343294"><a href="#local-6989586621679343294"><span class="hs-identifier">attr</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343295"><a href="#local-6989586621679343295"><span class="hs-identifier">displayText</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343296"><a href="#local-6989586621679343296"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343297"><a href="#local-6989586621679343297"><span class="hs-identifier">charWidth</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;HorizText &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343295"><span class="hs-identifier hs-var">displayText</span></a><span>
</span><a name="line-146"></a><span>                       </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;@(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343294"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span>
</span><a name="line-147"></a><span>                               </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343296"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span>
</span><a name="line-148"></a><span>                               </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343297"><span class="hs-identifier hs-var">charWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343298"><a href="#local-6989586621679343298"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343299"><a href="#local-6989586621679343299"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;BGFill (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343298"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343299"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">partLeft</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343300"><a href="#local-6989586621679343300"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">partRight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343301"><a href="#local-6989586621679343301"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343302"><a href="#local-6989586621679343302"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;HorizJoin &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343302"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343300"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &lt;|&gt; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343301"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">partTop</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343303"><a href="#local-6989586621679343303"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">partBottom</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343304"><a href="#local-6989586621679343304"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343305"><a href="#local-6989586621679343305"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343306"><a href="#local-6989586621679343306"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;VertJoin [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343305"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343306"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;] (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343303"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;) &lt;-&gt; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343304"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier hs-var">CropRight</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343307"><a href="#local-6989586621679343307"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343308"><a href="#local-6989586621679343308"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343309"><a href="#local-6989586621679343309"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropRight [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343308"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343309"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-157"></a><span>                     </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343307"><span class="hs-identifier hs-var">croppedImage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier hs-var">CropLeft</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343310"><a href="#local-6989586621679343310"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343311"><a href="#local-6989586621679343311"><span class="hs-identifier">leftSkip</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343312"><a href="#local-6989586621679343312"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343313"><a href="#local-6989586621679343313"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropLeft [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343311"><span class="hs-identifier hs-var">leftSkip</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343312"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343313"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-160"></a><span>                    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343310"><span class="hs-identifier hs-var">croppedImage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier hs-var">CropBottom</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343314"><a href="#local-6989586621679343314"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343315"><a href="#local-6989586621679343315"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343316"><a href="#local-6989586621679343316"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropBottom [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343315"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343316"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-163"></a><span>                      </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343314"><span class="hs-identifier hs-var">croppedImage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier hs-var">CropTop</span></a><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679343317"><a href="#local-6989586621679343317"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343318"><a href="#local-6989586621679343318"><span class="hs-identifier">topSkip</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343319"><a href="#local-6989586621679343319"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343320"><a href="#local-6989586621679343320"><span class="hs-identifier">outputHeight</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropTop [&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343318"><span class="hs-identifier hs-var">topSkip</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343319"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343320"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-166"></a><span>                   </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; (&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343317"><span class="hs-identifier hs-var">croppedImage</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;EmptyImage&quot;</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">-- | pretty print just the structure of an image.</span><span>
</span><a name="line-170"></a><span class="hs-identifier">ppImageStructure</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-171"></a><a name="ppImageStructure"><a href="Graphics.Vty.Image.Internal.html#ppImageStructure"><span class="hs-identifier">ppImageStructure</span></a></a><span> </span><a name="local-6989586621679343182"><a href="#local-6989586621679343182"><span class="hs-identifier">inImg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679343182"><span class="hs-identifier hs-var">inImg</span></a><span>
</span><a name="line-172"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>        </span><a name="local-6989586621679343183"><a href="#local-6989586621679343183"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679343186"><a href="#local-6989586621679343186"><span class="hs-identifier">indent</span></a></a><span> </span><a name="local-6989586621679343187"><a href="#local-6989586621679343187"><span class="hs-identifier">img</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343184"><span class="hs-identifier hs-var">tab</span></a><span> </span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343185"><span class="hs-identifier hs-var">pp</span></a><span> </span><a href="#local-6989586621679343186"><span class="hs-identifier hs-var">indent</span></a><span> </span><a href="#local-6989586621679343187"><span class="hs-identifier hs-var">img</span></a><span>
</span><a name="line-174"></a><span>        </span><a name="local-6989586621679343184"><a href="#local-6989586621679343184"><span class="hs-identifier">tab</span></a></a><span> </span><a name="local-6989586621679343188"><a href="#local-6989586621679343188"><span class="hs-identifier">indent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679343188"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-string">&quot;  &quot;</span><span>
</span><a name="line-175"></a><span>        </span><a name="local-6989586621679343185"><a href="#local-6989586621679343185"><span class="hs-identifier">pp</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343189"><a href="#local-6989586621679343189"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;HorizText(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343189"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-176"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343190"><a href="#local-6989586621679343190"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343191"><a href="#local-6989586621679343191"><span class="hs-identifier">outputHeight</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;BGFill(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343190"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343191"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-178"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343192"><a href="#local-6989586621679343192"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">partLeft</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343193"><a href="#local-6989586621679343193"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">partRight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343194"><a href="#local-6989586621679343194"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343195"><a href="#local-6989586621679343195"><span class="hs-identifier">c</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;HorizJoin(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343195"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343192"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343193"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343192"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343194"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-180"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343196"><a href="#local-6989586621679343196"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">partTop</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343197"><a href="#local-6989586621679343197"><span class="hs-identifier">t</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">partBottom</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343198"><a href="#local-6989586621679343198"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343199"><a href="#local-6989586621679343199"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343200"><a href="#local-6989586621679343200"><span class="hs-identifier">r</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;VertJoin(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343199"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343200"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-182"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343197"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-183"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343196"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343198"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-184"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343201"><a href="#local-6989586621679343201"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier hs-var">CropRight</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343202"><a href="#local-6989586621679343202"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343203"><a href="#local-6989586621679343203"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343204"><a href="#local-6989586621679343204"><span class="hs-identifier">outputHeight</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropRight(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343203"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343204"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-186"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343201"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343202"><span class="hs-identifier hs-var">croppedImage</span></a><span>
</span><a name="line-187"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343205"><a href="#local-6989586621679343205"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier hs-var">CropLeft</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343206"><a href="#local-6989586621679343206"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343207"><a href="#local-6989586621679343207"><span class="hs-identifier">leftSkip</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343208"><a href="#local-6989586621679343208"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343209"><a href="#local-6989586621679343209"><span class="hs-identifier">outputHeight</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropLeft(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343207"><span class="hs-identifier hs-var">leftSkip</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343208"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343209"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-189"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343205"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343206"><span class="hs-identifier hs-var">croppedImage</span></a><span>
</span><a name="line-190"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343210"><a href="#local-6989586621679343210"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier hs-var">CropBottom</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343211"><a href="#local-6989586621679343211"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343212"><a href="#local-6989586621679343212"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343213"><a href="#local-6989586621679343213"><span class="hs-identifier">outputHeight</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-191"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropBottom(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343212"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343213"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-192"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343210"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343211"><span class="hs-identifier hs-var">croppedImage</span></a><span>
</span><a name="line-193"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><a name="local-6989586621679343214"><a href="#local-6989586621679343214"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier hs-var">CropTop</span></a><span> </span><span class="hs-special">{</span><a name="local-6989586621679343215"><a href="#local-6989586621679343215"><span class="hs-identifier">croppedImage</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343216"><a href="#local-6989586621679343216"><span class="hs-identifier">topSkip</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343217"><a href="#local-6989586621679343217"><span class="hs-identifier">outputWidth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679343218"><a href="#local-6989586621679343218"><span class="hs-identifier">outputHeight</span></a></a><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;CropTop(&quot;</span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343217"><span class="hs-identifier hs-var">outputWidth</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343216"><span class="hs-identifier hs-var">topSkip</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;-&gt;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679343218"><span class="hs-identifier hs-var">outputHeight</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)\n&quot;</span><span>
</span><a name="line-195"></a><span>              </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679343183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343214"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343215"><span class="hs-identifier hs-var">croppedImage</span></a><span>
</span><a name="line-196"></a><span>        </span><span class="hs-identifier">pp</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;EmptyImage&quot;</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-199"></a><span>    </span><a name="local-8214565720323793159"><span class="hs-identifier">rnf</span></a><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier hs-var">CropRight</span></a><span> </span><a name="local-6989586621679343266"><a href="#local-6989586621679343266"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679343267"><a href="#local-6989586621679343267"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343268"><a href="#local-6989586621679343268"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343266"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343267"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343268"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier hs-var">CropLeft</span></a><span> </span><a name="local-6989586621679343269"><a href="#local-6989586621679343269"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679343270"><a href="#local-6989586621679343270"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679343271"><a href="#local-6989586621679343271"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343272"><a href="#local-6989586621679343272"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343269"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343270"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343271"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343272"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier hs-var">CropBottom</span></a><span> </span><a name="local-6989586621679343273"><a href="#local-6989586621679343273"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679343274"><a href="#local-6989586621679343274"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343275"><a href="#local-6989586621679343275"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343273"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343274"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343275"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier hs-var">CropTop</span></a><span> </span><a name="local-6989586621679343276"><a href="#local-6989586621679343276"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679343277"><a href="#local-6989586621679343277"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679343278"><a href="#local-6989586621679343278"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343279"><a href="#local-6989586621679343279"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343276"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343277"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343278"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343279"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><a name="local-6989586621679343280"><a href="#local-6989586621679343280"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343281"><a href="#local-6989586621679343281"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343280"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343281"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><a name="local-6989586621679343282"><a href="#local-6989586621679343282"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679343283"><a href="#local-6989586621679343283"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679343284"><a href="#local-6989586621679343284"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343285"><a href="#local-6989586621679343285"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343282"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343283"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343284"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343285"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a name="local-6989586621679343286"><a href="#local-6989586621679343286"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679343287"><a href="#local-6989586621679343287"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679343288"><a href="#local-6989586621679343288"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343289"><a href="#local-6989586621679343289"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343286"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343287"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343288"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343289"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-identifier">rnf</span><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><a name="local-6989586621679343290"><a href="#local-6989586621679343290"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679343291"><a href="#local-6989586621679343291"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679343292"><a href="#local-6989586621679343292"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679343293"><a href="#local-6989586621679343293"><span class="hs-identifier">cw</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343290"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343291"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">deepseq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343292"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679343293"><span class="hs-identifier hs-var">cw</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | The width of an Image. This is the number display columns the image</span><span>
</span><a name="line-210"></a><span class="hs-comment">-- will occupy.</span><span>
</span><a name="line-211"></a><span class="hs-identifier">imageWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-212"></a><a name="imageWidth"><a href="Graphics.Vty.Image.Internal.html#imageWidth"><span class="hs-identifier">imageWidth</span></a></a><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343219"><a href="#local-6989586621679343219"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343219"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-213"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343220"><a href="#local-6989586621679343220"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343220"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-214"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343221"><a href="#local-6989586621679343221"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343221"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-215"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343222"><a href="#local-6989586621679343222"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343222"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-216"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier hs-var">CropRight</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343223"><a href="#local-6989586621679343223"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343223"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-217"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier hs-var">CropLeft</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343224"><a href="#local-6989586621679343224"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343224"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-218"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier hs-var">CropBottom</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343225"><a href="#local-6989586621679343225"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343225"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-219"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier hs-var">CropTop</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343226"><a href="#local-6989586621679343226"><span class="hs-identifier">w</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343226"><span class="hs-identifier hs-var">w</span></a><span>
</span><a name="line-220"></a><span class="hs-identifier">imageWidth</span><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- | The height of an Image. This is the number of display rows the</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- image will occupy.</span><span>
</span><a name="line-224"></a><span class="hs-identifier">imageHeight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-225"></a><a name="imageHeight"><a href="Graphics.Vty.Image.Internal.html#imageHeight"><span class="hs-identifier">imageHeight</span></a></a><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-226"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343227"><a href="#local-6989586621679343227"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343227"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-227"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343228"><a href="#local-6989586621679343228"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343228"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-228"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343229"><a href="#local-6989586621679343229"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343229"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-229"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropRight"><span class="hs-identifier hs-var">CropRight</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343230"><a href="#local-6989586621679343230"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343230"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-230"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropLeft"><span class="hs-identifier hs-var">CropLeft</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span>  </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343231"><a href="#local-6989586621679343231"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343231"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-231"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropBottom"><span class="hs-identifier hs-var">CropBottom</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343232"><a href="#local-6989586621679343232"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343232"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-232"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#CropTop"><span class="hs-identifier hs-var">CropTop</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputHeight</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679343233"><a href="#local-6989586621679343233"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343233"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-233"></a><span class="hs-identifier">imageHeight</span><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | Append in the Monoid instance is equivalent to &lt;-&gt;.</span><span>
</span><a name="line-236"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>    </span><a name="local-3458764513820541442"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span>
</span><a name="line-238"></a><span>    </span><a name="local-3458764513820541443"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#vertJoin"><span class="hs-identifier hs-var">vertJoin</span></a><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | combines two images side by side</span><span>
</span><a name="line-241"></a><span class="hs-comment">--</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- Combines text chunks where possible. Assures outputWidth and</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- outputHeight properties are not violated.</span><span>
</span><a name="line-244"></a><span class="hs-comment">--</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- The result image will have a width equal to the sum of the two images</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- width. And the height will equal the largest height of the two</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- images. The area not defined in one image due to a height missmatch</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- will be filled with the background pattern.</span><span>
</span><a name="line-249"></a><span class="hs-identifier">horizJoin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-250"></a><a name="horizJoin"><a href="Graphics.Vty.Image.Internal.html#horizJoin"><span class="hs-identifier">horizJoin</span></a></a><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><a name="local-6989586621679343234"><a href="#local-6989586621679343234"><span class="hs-identifier">i</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343234"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-251"></a><span class="hs-identifier">horizJoin</span><span> </span><a name="local-6989586621679343235"><a href="#local-6989586621679343235"><span class="hs-identifier">i</span></a></a><span>          </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343235"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-252"></a><span class="hs-identifier">horizJoin</span><span> </span><a name="local-6989586621679343236"><a href="#local-6989586621679343236"><span class="hs-identifier">i0</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><a name="local-6989586621679343237"><a href="#local-6989586621679343237"><span class="hs-identifier">a0</span></a></a><span> </span><a name="local-6989586621679343238"><a href="#local-6989586621679343238"><span class="hs-identifier">t0</span></a></a><span> </span><a name="local-6989586621679343239"><a href="#local-6989586621679343239"><span class="hs-identifier">w0</span></a></a><span> </span><a name="local-6989586621679343240"><a href="#local-6989586621679343240"><span class="hs-identifier">cw0</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679343241"><a href="#local-6989586621679343241"><span class="hs-identifier">i1</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><a name="local-6989586621679343242"><a href="#local-6989586621679343242"><span class="hs-identifier">a1</span></a></a><span> </span><a name="local-6989586621679343243"><a href="#local-6989586621679343243"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679343244"><a href="#local-6989586621679343244"><span class="hs-identifier">w1</span></a></a><span> </span><a name="local-6989586621679343245"><a href="#local-6989586621679343245"><span class="hs-identifier">cw1</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343237"><span class="hs-identifier hs-var">a0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679343242"><span class="hs-identifier hs-var">a1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizText"><span class="hs-identifier hs-var">HorizText</span></a><span> </span><a href="#local-6989586621679343237"><span class="hs-identifier hs-var">a0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">append</span><span> </span><a href="#local-6989586621679343238"><span class="hs-identifier hs-var">t0</span></a><span> </span><a href="#local-6989586621679343243"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343239"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679343244"><span class="hs-identifier hs-var">w1</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343240"><span class="hs-identifier hs-var">cw0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679343245"><span class="hs-identifier hs-var">cw1</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>    </span><span class="hs-comment">-- assumes horiz text height is always 1</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a href="#local-6989586621679343236"><span class="hs-identifier hs-var">i0</span></a><span> </span><a href="#local-6989586621679343241"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679343239"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679343244"><span class="hs-identifier hs-var">w1</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-256"></a><span class="hs-identifier">horizJoin</span><span> </span><a name="local-6989586621679343246"><a href="#local-6989586621679343246"><span class="hs-identifier">i0</span></a></a><span> </span><a name="local-6989586621679343247"><a href="#local-6989586621679343247"><span class="hs-identifier">i1</span></a></a><span>
</span><a name="line-257"></a><span>    </span><span class="hs-comment">-- If the images are of the same height then no padding is required</span><span>
</span><a name="line-258"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a href="#local-6989586621679343246"><span class="hs-identifier hs-var">i0</span></a><span> </span><a href="#local-6989586621679343247"><span class="hs-identifier hs-var">i1</span></a><span> </span><a href="#local-6989586621679343250"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span>
</span><a name="line-259"></a><span>    </span><span class="hs-comment">-- otherwise one of the images needs to be padded to the right size.</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span>  </span><span class="hs-comment">-- Pad i0</span><span>
</span><a name="line-261"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679343253"><a href="#local-6989586621679343253"><span class="hs-identifier">padAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span>
</span><a name="line-262"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><a href="#local-6989586621679343246"><span class="hs-identifier hs-var">i0</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><a href="#local-6989586621679343248"><span class="hs-identifier hs-var">w0</span></a><span> </span><a href="#local-6989586621679343253"><span class="hs-identifier hs-var">padAmount</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343248"><span class="hs-identifier hs-var">w0</span></a><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343247"><span class="hs-identifier hs-var">i1</span></a><span> </span><a href="#local-6989586621679343250"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span>
</span><a name="line-263"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span>  </span><span class="hs-comment">-- Pad i1</span><span>
</span><a name="line-264"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679343254"><a href="#local-6989586621679343254"><span class="hs-identifier">padAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679343252"><span class="hs-identifier hs-var">h1</span></a><span>
</span><a name="line-265"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a href="#local-6989586621679343246"><span class="hs-identifier hs-var">i0</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><a href="#local-6989586621679343247"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><a href="#local-6989586621679343249"><span class="hs-identifier hs-var">w1</span></a><span> </span><a href="#local-6989586621679343254"><span class="hs-identifier hs-var">padAmount</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343249"><span class="hs-identifier hs-var">w1</span></a><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343250"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="#local-6989586621679343251"><span class="hs-identifier hs-var">h0</span></a><span>
</span><a name="line-266"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-267"></a><span>        </span><a name="local-6989586621679343248"><a href="#local-6989586621679343248"><span class="hs-identifier">w0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageWidth"><span class="hs-identifier hs-var">imageWidth</span></a><span> </span><a href="#local-6989586621679343246"><span class="hs-identifier hs-var">i0</span></a><span>
</span><a name="line-268"></a><span>        </span><a name="local-6989586621679343249"><a href="#local-6989586621679343249"><span class="hs-identifier">w1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageWidth"><span class="hs-identifier hs-var">imageWidth</span></a><span> </span><a href="#local-6989586621679343247"><span class="hs-identifier hs-var">i1</span></a><span>
</span><a name="line-269"></a><span>        </span><a name="local-6989586621679343250"><a href="#local-6989586621679343250"><span class="hs-identifier">w</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343248"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679343249"><span class="hs-identifier hs-var">w1</span></a><span>
</span><a name="line-270"></a><span>        </span><a name="local-6989586621679343251"><a href="#local-6989586621679343251"><span class="hs-identifier">h0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageHeight"><span class="hs-identifier hs-var">imageHeight</span></a><span> </span><a href="#local-6989586621679343246"><span class="hs-identifier hs-var">i0</span></a><span>
</span><a name="line-271"></a><span>        </span><a name="local-6989586621679343252"><a href="#local-6989586621679343252"><span class="hs-identifier">h1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageHeight"><span class="hs-identifier hs-var">imageHeight</span></a><span> </span><a href="#local-6989586621679343247"><span class="hs-identifier hs-var">i1</span></a><span>
</span><a name="line-272"></a><span class="hs-identifier">horizJoin</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;horizJoin applied to undefined values.&quot;</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- | combines two images vertically</span><span>
</span><a name="line-275"></a><span class="hs-comment">--</span><span>
</span><a name="line-276"></a><span class="hs-comment">-- The result image will have a height equal to the sum of the heights</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- of both images. The width will equal the largest width of the two</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- images. The area not defined in one image due to a width missmatch</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- will be filled with the background pattern.</span><span>
</span><a name="line-280"></a><span class="hs-identifier">vertJoin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Graphics.Vty.Image.Internal.html#Image"><span class="hs-identifier hs-type">Image</span></a><span>
</span><a name="line-281"></a><a name="vertJoin"><a href="Graphics.Vty.Image.Internal.html#vertJoin"><span class="hs-identifier">vertJoin</span></a></a><span> </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><a name="local-6989586621679343255"><a href="#local-6989586621679343255"><span class="hs-identifier">i</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343255"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-282"></a><span class="hs-identifier">vertJoin</span><span> </span><a name="local-6989586621679343256"><a href="#local-6989586621679343256"><span class="hs-identifier">i</span></a></a><span>          </span><a href="Graphics.Vty.Image.Internal.html#EmptyImage"><span class="hs-identifier hs-var">EmptyImage</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343256"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-283"></a><span class="hs-identifier">vertJoin</span><span> </span><a name="local-6989586621679343257"><a href="#local-6989586621679343257"><span class="hs-identifier">i0</span></a></a><span> </span><a name="local-6989586621679343258"><a href="#local-6989586621679343258"><span class="hs-identifier">i1</span></a></a><span>
</span><a name="line-284"></a><span>    </span><span class="hs-comment">-- If the images are of the same width then no background padding is</span><span>
</span><a name="line-285"></a><span>    </span><span class="hs-comment">-- required</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><a href="#local-6989586621679343257"><span class="hs-identifier hs-var">i0</span></a><span> </span><a href="#local-6989586621679343258"><span class="hs-identifier hs-var">i1</span></a><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><a href="#local-6989586621679343263"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-287"></a><span>    </span><span class="hs-comment">-- Otherwise one of the images needs to be padded to the size of the</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-comment">-- other image.</span><span>
</span><a name="line-289"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span>
</span><a name="line-290"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679343264"><a href="#local-6989586621679343264"><span class="hs-identifier">padAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span>
</span><a name="line-291"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a href="#local-6989586621679343257"><span class="hs-identifier hs-var">i0</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><a href="#local-6989586621679343264"><span class="hs-identifier hs-var">padAmount</span></a><span> </span><a href="#local-6989586621679343261"><span class="hs-identifier hs-var">h0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span> </span><a href="#local-6989586621679343261"><span class="hs-identifier hs-var">h0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343258"><span class="hs-identifier hs-var">i1</span></a><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span> </span><a href="#local-6989586621679343263"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-292"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span>
</span><a name="line-293"></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679343265"><a href="#local-6989586621679343265"><span class="hs-identifier">padAmount</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679343260"><span class="hs-identifier hs-var">w1</span></a><span>
</span><a name="line-294"></a><span>          </span><span class="hs-keyword">in</span><span> </span><a href="Graphics.Vty.Image.Internal.html#VertJoin"><span class="hs-identifier hs-var">VertJoin</span></a><span> </span><a href="#local-6989586621679343257"><span class="hs-identifier hs-var">i0</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#HorizJoin"><span class="hs-identifier hs-var">HorizJoin</span></a><span> </span><a href="#local-6989586621679343258"><span class="hs-identifier hs-var">i1</span></a><span> </span><span class="hs-special">(</span><a href="Graphics.Vty.Image.Internal.html#BGFill"><span class="hs-identifier hs-var">BGFill</span></a><span> </span><a href="#local-6989586621679343265"><span class="hs-identifier hs-var">padAmount</span></a><span> </span><a href="#local-6989586621679343262"><span class="hs-identifier hs-var">h1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><a href="#local-6989586621679343262"><span class="hs-identifier hs-var">h1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679343259"><span class="hs-identifier hs-var">w0</span></a><span> </span><a href="#local-6989586621679343263"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-295"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-296"></a><span>        </span><a name="local-6989586621679343259"><a href="#local-6989586621679343259"><span class="hs-identifier">w0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageWidth"><span class="hs-identifier hs-var">imageWidth</span></a><span> </span><a href="#local-6989586621679343257"><span class="hs-identifier hs-var">i0</span></a><span>
</span><a name="line-297"></a><span>        </span><a name="local-6989586621679343260"><a href="#local-6989586621679343260"><span class="hs-identifier">w1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageWidth"><span class="hs-identifier hs-var">imageWidth</span></a><span> </span><a href="#local-6989586621679343258"><span class="hs-identifier hs-var">i1</span></a><span>
</span><a name="line-298"></a><span>        </span><a name="local-6989586621679343261"><a href="#local-6989586621679343261"><span class="hs-identifier">h0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageHeight"><span class="hs-identifier hs-var">imageHeight</span></a><span> </span><a href="#local-6989586621679343257"><span class="hs-identifier hs-var">i0</span></a><span>
</span><a name="line-299"></a><span>        </span><a name="local-6989586621679343262"><a href="#local-6989586621679343262"><span class="hs-identifier">h1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Graphics.Vty.Image.Internal.html#imageHeight"><span class="hs-identifier hs-var">imageHeight</span></a><span> </span><a href="#local-6989586621679343258"><span class="hs-identifier hs-var">i1</span></a><span>
</span><a name="line-300"></a><span>        </span><a name="local-6989586621679343263"><a href="#local-6989586621679343263"><span class="hs-identifier">h</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679343261"><span class="hs-identifier hs-var">h0</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679343262"><span class="hs-identifier hs-var">h1</span></a><span>
</span><a name="line-301"></a><span class="hs-identifier">vertJoin</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;vertJoin applied to undefined values.&quot;</span><span>
</span><a name="line-302"></a></pre></body></html>