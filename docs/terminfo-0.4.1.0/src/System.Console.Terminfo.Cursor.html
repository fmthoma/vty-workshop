<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 703</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-4"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Maintainer  : judah.jacobson@gmail.com</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Portability : portable (FFI)</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- This module provides capabilities for moving the cursor on the terminal.</span><span>
</span><a name="line-11"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Console</span><span class="hs-operator">.</span><span class="hs-identifier">Terminfo</span><span class="hs-operator">.</span><span class="hs-identifier">Cursor</span><span class="hs-special">(</span><span>
</span><a name="line-12"></a><span>                        </span><span class="hs-comment">-- * Terminal dimensions</span><span>
</span><a name="line-13"></a><span>                        </span><span class="hs-comment">-- | Get the default size of the terminal.  For</span><span>
</span><a name="line-14"></a><span>                        </span><span class="hs-comment">-- resizeable terminals (e.g., @xterm@), these may not</span><span>
</span><a name="line-15"></a><span>                        </span><span class="hs-comment">-- correspond to the actual dimensions.</span><span>
</span><a name="line-16"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#termLines"><span class="hs-identifier hs-var">termLines</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.Terminfo.Cursor.html#termColumns"><span class="hs-identifier hs-var">termColumns</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>                        </span><span class="hs-comment">-- * Cursor flags</span><span>
</span><a name="line-18"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#autoRightMargin"><span class="hs-identifier hs-var">autoRightMargin</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#autoLeftMargin"><span class="hs-identifier hs-var">autoLeftMargin</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#wraparoundGlitch"><span class="hs-identifier hs-var">wraparoundGlitch</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span>                        </span><span class="hs-comment">-- * Scrolling</span><span>
</span><a name="line-22"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#carriageReturn"><span class="hs-identifier hs-var">carriageReturn</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#newline"><span class="hs-identifier hs-var">newline</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#scrollForward"><span class="hs-identifier hs-var">scrollForward</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#scrollReverse"><span class="hs-identifier hs-var">scrollReverse</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                        </span><span class="hs-comment">-- * Relative cursor movements</span><span>
</span><a name="line-27"></a><span>                        </span><span class="hs-comment">-- | The following functions for cursor movement will</span><span>
</span><a name="line-28"></a><span>                        </span><span class="hs-comment">-- combine the more primitive capabilities.  For example,</span><span>
</span><a name="line-29"></a><span>                        </span><span class="hs-comment">-- 'moveDown' may use either 'cursorDown' or</span><span>
</span><a name="line-30"></a><span>                        </span><span class="hs-comment">-- 'cursorDown1' depending on the parameter and which of</span><span>
</span><a name="line-31"></a><span>                        </span><span class="hs-comment">-- @cud@ and @cud1@ are defined.</span><span>
</span><a name="line-32"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#moveDown"><span class="hs-identifier hs-var">moveDown</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.Terminfo.Cursor.html#moveLeft"><span class="hs-identifier hs-var">moveLeft</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.Terminfo.Cursor.html#moveRight"><span class="hs-identifier hs-var">moveRight</span></a><span class="hs-special">,</span><span> </span><a href="System.Console.Terminfo.Cursor.html#moveUp"><span class="hs-identifier hs-var">moveUp</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>                        </span><span>
</span><a name="line-34"></a><span>                        </span><span class="hs-comment">-- ** Primitive movement capabilities</span><span>
</span><a name="line-35"></a><span>                        </span><span class="hs-comment">-- | These capabilities correspond directly to @cub@, @cud@,</span><span>
</span><a name="line-36"></a><span>                        </span><span class="hs-comment">-- @cub1@, @cud1@, etc.</span><span>
</span><a name="line-37"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorDown1"><span class="hs-identifier hs-var">cursorDown1</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-38"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorLeft1"><span class="hs-identifier hs-var">cursorLeft1</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorRight1"><span class="hs-identifier hs-var">cursorRight1</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorUp1"><span class="hs-identifier hs-var">cursorUp1</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-41"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorDown"><span class="hs-identifier hs-var">cursorDown</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-42"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorLeft"><span class="hs-identifier hs-var">cursorLeft</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorRight"><span class="hs-identifier hs-var">cursorRight</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorUp"><span class="hs-identifier hs-var">cursorUp</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-45"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorHome"><span class="hs-identifier hs-var">cursorHome</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorToLL"><span class="hs-identifier hs-var">cursorToLL</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>                        </span><span class="hs-comment">-- * Absolute cursor movements</span><span>
</span><a name="line-48"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#cursorAddress"><span class="hs-identifier hs-var">cursorAddress</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#Point"><span class="hs-identifier hs-type">Point</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#rowAddress"><span class="hs-identifier hs-var">rowAddress</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>                        </span><a href="System.Console.Terminfo.Cursor.html#columnAddress"><span class="hs-identifier hs-var">columnAddress</span></a><span>
</span><a name="line-52"></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><a href="System.Console.Terminfo.Base.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Console</span><span class="hs-operator">.</span><span class="hs-identifier">Terminfo</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">termLines</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-58"></a><span class="hs-identifier">termColumns</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-59"></a><a name="termLines"><a href="System.Console.Terminfo.Cursor.html#termLines"><span class="hs-identifier">termLines</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetNum"><span class="hs-identifier hs-var">tiGetNum</span></a><span> </span><span class="hs-string">&quot;lines&quot;</span><span>
</span><a name="line-60"></a><a name="termColumns"><a href="System.Console.Terminfo.Cursor.html#termColumns"><span class="hs-identifier">termColumns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetNum"><span class="hs-identifier hs-var">tiGetNum</span></a><span> </span><span class="hs-string">&quot;cols&quot;</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | This flag specifies that the cursor wraps automatically from the last </span><span>
</span><a name="line-63"></a><span class="hs-comment">-- column of one line to the first column of the next.</span><span>
</span><a name="line-64"></a><span class="hs-identifier">autoRightMargin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-65"></a><a name="autoRightMargin"><a href="System.Console.Terminfo.Cursor.html#autoRightMargin"><span class="hs-identifier">autoRightMargin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetFlag"><span class="hs-identifier hs-var">tiGetFlag</span></a><span> </span><span class="hs-string">&quot;am&quot;</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | This flag specifies that a backspace at column 0 wraps the cursor to</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- the last column of the previous line.</span><span>
</span><a name="line-69"></a><span class="hs-identifier">autoLeftMargin</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-70"></a><a name="autoLeftMargin"><a href="System.Console.Terminfo.Cursor.html#autoLeftMargin"><span class="hs-identifier">autoLeftMargin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetFlag"><span class="hs-identifier hs-var">tiGetFlag</span></a><span> </span><span class="hs-string">&quot;bw&quot;</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | This flag specifies that the terminal does not perform</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- 'autoRightMargin'-style wrapping when the character which would cause the </span><span>
</span><a name="line-74"></a><span class="hs-comment">-- wraparound is a control character.</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- This is also known as the \&quot;newline glitch\&quot; or \&quot;magic wrap\&quot;.  </span><span>
</span><a name="line-76"></a><span class="hs-comment">-- </span><span>
</span><a name="line-77"></a><span class="hs-comment">-- For example, in an 80-column terminal with this behavior, the following </span><span>
</span><a name="line-78"></a><span class="hs-comment">-- will print single-spaced instead of double-spaced:</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- </span><span>
</span><a name="line-80"></a><span class="hs-comment">-- &gt; replicateM_ 5 $ putStr $ replicate 80 'x' ++ &quot;\n&quot;</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- </span><span>
</span><a name="line-82"></a><span class="hs-identifier">wraparoundGlitch</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-83"></a><a name="wraparoundGlitch"><a href="System.Console.Terminfo.Cursor.html#wraparoundGlitch"><span class="hs-identifier">wraparoundGlitch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetFlag"><span class="hs-identifier hs-var">tiGetFlag</span></a><span> </span><span class="hs-string">&quot;xenl&quot;</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">{--
On many terminals, the @cud1@ ('cursorDown1') capability is the line feed 
character '\n'.  However, @stty@ settings may cause that character to have
other effects than intended; e.g. ONLCR turns LF into CRLF, and as a result 
@cud1@ will always move the cursor to the first column of the next line.  

Looking at the source code of curses (lib_mvcur.c) and other similar programs, 
they use @cud@ instead of @cud1@ if it's '\n' and ONLCR is turned on.  

Since there's no easy way to check for ONLCR at this point, I've just made
moveDown only use cud1 if it's not '\n'.
Suggestions are welcome.
--}</span><span>
</span><a name="line-98"></a><span class="hs-identifier">cursorDown1Fixed</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046807"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046807"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-99"></a><a name="cursorDown1Fixed"><a href="System.Console.Terminfo.Cursor.html#cursorDown1Fixed"><span class="hs-identifier">cursorDown1Fixed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-100"></a><span>    </span><a name="local-6989586621679046808"><a href="#local-6989586621679046808"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cud1&quot;</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier hs-var">guard</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679046808"><span class="hs-identifier hs-var">str</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>    </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cud1&quot;</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-identifier">cursorDown1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046806"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046806"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-105"></a><a name="cursorDown1"><a href="System.Console.Terminfo.Cursor.html#cursorDown1"><span class="hs-identifier">cursorDown1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cud1&quot;</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-identifier">cursorLeft1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046805"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046805"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-108"></a><a name="cursorLeft1"><a href="System.Console.Terminfo.Cursor.html#cursorLeft1"><span class="hs-identifier">cursorLeft1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cub1&quot;</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-identifier">cursorRight1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046804"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046804"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-111"></a><a name="cursorRight1"><a href="System.Console.Terminfo.Cursor.html#cursorRight1"><span class="hs-identifier">cursorRight1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cuf1&quot;</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">cursorUp1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046803"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046803"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-114"></a><a name="cursorUp1"><a href="System.Console.Terminfo.Cursor.html#cursorUp1"><span class="hs-identifier">cursorUp1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cuu1&quot;</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-identifier">cursorDown</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046802"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046802"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><a name="cursorDown"><a href="System.Console.Terminfo.Cursor.html#cursorDown"><span class="hs-identifier">cursorDown</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cud&quot;</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">cursorLeft</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046801"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046801"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><a name="cursorLeft"><a href="System.Console.Terminfo.Cursor.html#cursorLeft"><span class="hs-identifier">cursorLeft</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cub&quot;</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">cursorRight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046800"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046800"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><a name="cursorRight"><a href="System.Console.Terminfo.Cursor.html#cursorRight"><span class="hs-identifier">cursorRight</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cuf&quot;</span><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">cursorUp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046799"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046799"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><a name="cursorUp"><a href="System.Console.Terminfo.Cursor.html#cursorUp"><span class="hs-identifier">cursorUp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cuu&quot;</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">cursorHome</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046798"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046798"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-129"></a><a name="cursorHome"><a href="System.Console.Terminfo.Cursor.html#cursorHome"><span class="hs-identifier">cursorHome</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;home&quot;</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">cursorToLL</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046797"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046797"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-132"></a><a name="cursorToLL"><a href="System.Console.Terminfo.Cursor.html#cursorToLL"><span class="hs-identifier">cursorToLL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;ll&quot;</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- Movements are built out of parametrized and unparam'd movement</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- capabilities.</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- todo: more complicated logic like ncurses does.</span><span>
</span><a name="line-138"></a><span class="hs-identifier">move</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046796"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046796"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046796"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046796"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><a name="move"><a href="System.Console.Terminfo.Cursor.html#move"><span class="hs-identifier">move</span></a></a><span> </span><a name="local-6989586621679046809"><a href="#local-6989586621679046809"><span class="hs-identifier">single</span></a></a><span> </span><a name="local-6989586621679046810"><a href="#local-6989586621679046810"><span class="hs-identifier">param</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span>
</span><a name="line-141"></a><span>        </span><a name="local-6989586621679046811"><a href="#local-6989586621679046811"><span class="hs-identifier">tryBoth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-142"></a><span>                    </span><a name="local-6989586621679046813"><a href="#local-6989586621679046813"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679046809"><span class="hs-identifier hs-var">single</span></a><span>
</span><a name="line-143"></a><span>                    </span><a name="local-6989586621679046814"><a href="#local-6989586621679046814"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679046810"><span class="hs-identifier hs-var">param</span></a><span>
</span><a name="line-144"></a><span>                    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679046815"><a href="#local-6989586621679046815"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679046815"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-145"></a><span>                        </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-146"></a><span>                        </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046813"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-147"></a><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046814"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679046815"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-148"></a><span>        </span><a name="local-6989586621679046812"><a href="#local-6989586621679046812"><span class="hs-identifier">manySingle</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-149"></a><span>                        </span><a name="local-6989586621679046816"><a href="#local-6989586621679046816"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679046809"><span class="hs-identifier hs-var">single</span></a><span>
</span><a name="line-150"></a><span>                        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679046817"><a href="#local-6989586621679046817"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mconcat</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679046817"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679046816"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-151"></a><span>        </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679046811"><span class="hs-identifier hs-var">tryBoth</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679046810"><span class="hs-identifier hs-var">param</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679046812"><span class="hs-identifier hs-var">manySingle</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-identifier">moveLeft</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046795"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046795"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><a name="moveLeft"><a href="System.Console.Terminfo.Cursor.html#moveLeft"><span class="hs-identifier">moveLeft</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Cursor.html#move"><span class="hs-identifier hs-var">move</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorLeft1"><span class="hs-identifier hs-var">cursorLeft1</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorLeft"><span class="hs-identifier hs-var">cursorLeft</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">moveRight</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046794"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046794"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><a name="moveRight"><a href="System.Console.Terminfo.Cursor.html#moveRight"><span class="hs-identifier">moveRight</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Cursor.html#move"><span class="hs-identifier hs-var">move</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorRight1"><span class="hs-identifier hs-var">cursorRight1</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorRight"><span class="hs-identifier hs-var">cursorRight</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-identifier">moveUp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046793"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046793"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-160"></a><a name="moveUp"><a href="System.Console.Terminfo.Cursor.html#moveUp"><span class="hs-identifier">moveUp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Cursor.html#move"><span class="hs-identifier hs-var">move</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorUp1"><span class="hs-identifier hs-var">cursorUp1</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorUp"><span class="hs-identifier hs-var">cursorUp</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-identifier">moveDown</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046792"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046792"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><a name="moveDown"><a href="System.Console.Terminfo.Cursor.html#moveDown"><span class="hs-identifier">moveDown</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Cursor.html#move"><span class="hs-identifier hs-var">move</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorDown1Fixed"><span class="hs-identifier hs-var">cursorDown1Fixed</span></a><span> </span><a href="System.Console.Terminfo.Cursor.html#cursorDown"><span class="hs-identifier hs-var">cursorDown</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- | The @cr@ capability, which moves the cursor to the first column of the</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- current line.</span><span>
</span><a name="line-167"></a><span class="hs-identifier">carriageReturn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046791"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046791"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-168"></a><a name="carriageReturn"><a href="System.Console.Terminfo.Cursor.html#carriageReturn"><span class="hs-identifier">carriageReturn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cr&quot;</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- | The @nel@ capability, which moves the cursor to the first column of</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- the next line.  It behaves like a carriage return followed by a line feed.</span><span>
</span><a name="line-172"></a><span class="hs-comment">--</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- If @nel@ is not defined, this may be built out of other capabilities.</span><span>
</span><a name="line-174"></a><span class="hs-identifier">newline</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046790"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046790"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-175"></a><a name="newline"><a href="System.Console.Terminfo.Cursor.html#newline"><span class="hs-identifier">newline</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;nel&quot;</span><span> </span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftM2</span><span> </span><span class="hs-identifier hs-var">mappend</span><span> </span><a href="System.Console.Terminfo.Cursor.html#carriageReturn"><span class="hs-identifier hs-var">carriageReturn</span></a><span> </span><span>
</span><a name="line-177"></a><span>                            </span><span class="hs-special">(</span><a href="System.Console.Terminfo.Cursor.html#scrollForward"><span class="hs-identifier hs-var">scrollForward</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mplus</span><span class="hs-special">`</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cud1&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>        </span><span class="hs-comment">-- Note it's OK to use cud1 here, despite the stty problem referenced </span><span>
</span><a name="line-179"></a><span>        </span><span class="hs-comment">-- above, because carriageReturn already puts us on the first column.</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">scrollForward</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046789"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046789"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-182"></a><a name="scrollForward"><a href="System.Console.Terminfo.Cursor.html#scrollForward"><span class="hs-identifier">scrollForward</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;ind&quot;</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-identifier">scrollReverse</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046788"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><a href="#local-6989586621679046788"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-185"></a><a name="scrollReverse"><a href="System.Console.Terminfo.Cursor.html#scrollReverse"><span class="hs-identifier">scrollReverse</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;ri&quot;</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-keyword">data</span><span> </span><a name="Point"><a href="System.Console.Terminfo.Cursor.html#Point"><span class="hs-identifier">Point</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Point"><a href="System.Console.Terminfo.Cursor.html#Point"><span class="hs-identifier">Point</span></a></a><span> </span><span class="hs-special">{</span><a name="row"><a href="System.Console.Terminfo.Cursor.html#row"><span class="hs-identifier">row</span></a></a><span class="hs-special">,</span><span> </span><a name="col"><a href="System.Console.Terminfo.Cursor.html#col"><span class="hs-identifier">col</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">}</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-identifier">cursorAddress</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046787"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><a href="System.Console.Terminfo.Cursor.html#Point"><span class="hs-identifier hs-type">Point</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046787"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-191"></a><a name="cursorAddress"><a href="System.Console.Terminfo.Cursor.html#cursorAddress"><span class="hs-identifier">cursorAddress</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679046818"><a href="#local-6989586621679046818"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679046819"><a href="#local-6989586621679046819"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046818"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">row</span><span> </span><a href="#local-6989586621679046819"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">col</span><span> </span><a href="#local-6989586621679046819"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;cup&quot;</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-identifier">columnAddress</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046786"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046786"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-194"></a><a name="columnAddress"><a href="System.Console.Terminfo.Cursor.html#columnAddress"><span class="hs-identifier">columnAddress</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;hpa&quot;</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">rowAddress</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.Console.Terminfo.Base.html#TermStr"><span class="hs-identifier hs-type">TermStr</span></a><span> </span><a href="#local-6989586621679046785"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="System.Console.Terminfo.Base.html#Capability"><span class="hs-identifier hs-type">Capability</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046785"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><a name="rowAddress"><a href="System.Console.Terminfo.Cursor.html#rowAddress"><span class="hs-identifier">rowAddress</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Console.Terminfo.Base.html#tiGetOutput1"><span class="hs-identifier hs-var">tiGetOutput1</span></a><span> </span><span class="hs-string">&quot;vpa&quot;</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a></pre></body></html>