<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE
CPP,
MultiParamTypeClasses,
FunctionalDependencies,
FlexibleInstances,
UndecidableInstances,
TypeFamilies,
Trustworthy
  #-}</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- This is needed because ErrorT is deprecated.</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-warnings-deprecations #-}</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-comment">{- |
Module      :  Lens.Micro.Mtl
Copyright   :  (C) 2013-2016 Edward Kmett, 2015-2016 Artyom
License     :  BSD-style (see the file LICENSE)
-}</span><span>
</span><a name="line-20"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lens</span><span class="hs-operator">.</span><span class="hs-identifier">Micro</span><span class="hs-operator">.</span><span class="hs-identifier">Mtl</span><span>
</span><a name="line-21"></a><span class="hs-special">(</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-comment">-- * Getting</span><span>
</span><a name="line-23"></a><span>  </span><a href="Lens.Micro.Mtl.html#view"><span class="hs-identifier hs-var">view</span></a><span class="hs-special">,</span><span> </span><a href="Lens.Micro.Mtl.html#preview"><span class="hs-identifier hs-var">preview</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="Lens.Micro.Mtl.html#use"><span class="hs-identifier hs-var">use</span></a><span class="hs-special">,</span><span> </span><a href="Lens.Micro.Mtl.html#preuse"><span class="hs-identifier hs-var">preuse</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-comment">-- * Setting</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lens.Micro.Mtl.html#modifying"><span class="hs-identifier hs-var">modifying</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Lens.Micro.Mtl.html#assign"><span class="hs-identifier hs-var">assign</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3F%3D"><span class="hs-operator hs-var">?=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C~"><span class="hs-operator hs-var">&lt;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-comment">-- * Convenience</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%26~"><span class="hs-operator hs-var">&amp;~</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-comment">-- * Specialised modifying operators</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-comment">-- $arith-note</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%2B%3D"><span class="hs-operator hs-var">+=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#-%3D"><span class="hs-operator hs-var">-=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%2A%3D"><span class="hs-operator hs-var">*=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%2F%2F%3D"><span class="hs-operator hs-var">//=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-comment">-- * Setting with passthrough</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C%25%3D"><span class="hs-operator hs-var">&lt;%=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C.%3D"><span class="hs-operator hs-var">&lt;.=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C%3F%3D"><span class="hs-operator hs-var">&lt;?=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C%3C%25%3D"><span class="hs-operator hs-var">&lt;&lt;%=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#%3C%3C.%3D"><span class="hs-operator hs-var">&lt;&lt;.=</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>  </span><span class="hs-comment">-- * Zooming</span><span>
</span><a name="line-44"></a><span>  </span><a href="Lens.Micro.Mtl.Internal.html#zoom"><span class="hs-identifier hs-var">zoom</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="Lens.Micro.Mtl.Internal.html#magnify"><span class="hs-identifier hs-var">magnify</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Reader</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Reader</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">State</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- microlens</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Lens</span><span class="hs-operator">.</span><span class="hs-identifier">Micro</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Lens</span><span class="hs-operator">.</span><span class="hs-identifier">Micro</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- Internal modules</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span> </span><a href="Lens.Micro.Mtl.Internal.html"><span class="hs-identifier">Lens</span><span class="hs-operator">.</span><span class="hs-identifier">Micro</span><span class="hs-operator">.</span><span class="hs-identifier">Mtl</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{- |
'view' is a synonym for ('^.'), generalised for 'MonadReader' (we are able to use it instead of ('^.') since functions are instances of the 'MonadReader' class):

&gt;&gt;&gt; view _1 (1, 2)
1

When you're using 'Reader.Reader' for config and your config type has lenses generated for it, most of the time you'll be using 'view' instead of 'Reader.asks':

@
doSomething :: ('MonadReader' Config m) =&gt; m Int
doSomething = do
  thingy        &lt;- 'view' setting1  -- same as &#8220;'Reader.asks' ('^.' setting1)&#8221;
  anotherThingy &lt;- 'view' setting2
  ...
@
-}</span><span>
</span><a name="line-78"></a><span class="hs-identifier">view</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadReader</span><span> </span><a href="#local-6989586621679039626"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039627"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Getting</span><span> </span><a href="#local-6989586621679039628"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039626"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039628"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039627"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039628"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-79"></a><a name="view"><a href="Lens.Micro.Mtl.html#view"><span class="hs-identifier">view</span></a></a><span> </span><a name="local-6989586621679039629"><a href="#local-6989586621679039629"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Reader</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getConst</span><span> </span><span class="hs-operator hs-var">#.</span><span> </span><a href="#local-6989586621679039629"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-identifier hs-var">Const</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span class="hs-pragma">{-# INLINE view #-}</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">{- |
'preview' is a synonym for ('^?'), generalised for 'MonadReader' (just like 'view', which is a synonym for ('^.')).

&gt;&gt;&gt; preview each [1..5]
Just 1
-}</span><span>
</span><a name="line-88"></a><span class="hs-identifier">preview</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadReader</span><span> </span><a href="#local-6989586621679039623"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039624"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Getting</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">First</span><span> </span><a href="#local-6989586621679039625"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039623"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039625"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039624"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039625"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><a name="preview"><a href="Lens.Micro.Mtl.html#preview"><span class="hs-identifier">preview</span></a></a><span> </span><a name="local-6989586621679039630"><a href="#local-6989586621679039630"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Reader</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">getFirst</span><span> </span><span class="hs-operator hs-var">#.</span><span> </span><span class="hs-identifier hs-var">foldMapOf</span><span> </span><a href="#local-6989586621679039630"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">First</span><span> </span><span class="hs-operator hs-var">#.</span><span> </span><span class="hs-identifier hs-var">Just</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span class="hs-pragma">{-# INLINE preview #-}</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">{- |
'use' is ('^.') (or 'view') which implicitly operates on the state; for instance, if your state is a record containing a field @foo@, you can write

@
x \&lt;- 'use' foo
@

to extract @foo@ from the state. In other words, 'use' is the same as 'State.gets', but for getters instead of functions.

The implementation of 'use' is straightforward:

@
'use' l = 'State.gets' ('view' l)
@

If you need to extract something with a fold or traversal, you need 'preuse'.
-}</span><span>
</span><a name="line-109"></a><span class="hs-identifier">use</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039620"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039621"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Getting</span><span> </span><a href="#local-6989586621679039622"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039620"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039622"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039621"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039622"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-110"></a><a name="use"><a href="Lens.Micro.Mtl.html#use"><span class="hs-identifier">use</span></a></a><span> </span><a name="local-6989586621679039631"><a href="#local-6989586621679039631"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">gets</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#view"><span class="hs-identifier hs-var">view</span></a><span> </span><a href="#local-6989586621679039631"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span class="hs-pragma">{-# INLINE use #-}</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">{- |
'preuse' is ('^?') (or 'preview') which implicitly operates on the state &#8211; it takes the state and applies a traversal (or fold) to it to extract the 1st element the traversal points at.

@
'preuse' l = 'State.gets' ('preview' l)
@
-}</span><span>
</span><a name="line-120"></a><span class="hs-identifier">preuse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039617"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Getting</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">First</span><span> </span><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039617"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039618"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039619"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><a name="preuse"><a href="Lens.Micro.Mtl.html#preuse"><span class="hs-identifier">preuse</span></a></a><span> </span><a name="local-6989586621679039632"><a href="#local-6989586621679039632"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">gets</span><span> </span><span class="hs-special">(</span><a href="Lens.Micro.Mtl.html#preview"><span class="hs-identifier hs-var">preview</span></a><span> </span><a href="#local-6989586621679039632"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span class="hs-pragma">{-# INLINE preuse #-}</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">4</span><span> </span><span class="hs-operator">.=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">%=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">?=</span><span>
</span><a name="line-126"></a><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">4</span><span> </span><span class="hs-operator">&lt;&lt;.=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;&lt;%=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;%=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;.=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;?=</span><span>
</span><a name="line-127"></a><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">4</span><span> </span><span class="hs-operator">+=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">-=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">*=</span><span class="hs-special">,</span><span> </span><span class="hs-operator">//=</span><span>
</span><a name="line-128"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator">&lt;~</span><span>
</span><a name="line-129"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&amp;~</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">{- |
This can be used to chain lens operations using @op=@ syntax
rather than @op~@ syntax for simple non-type-changing cases.
&gt;&gt;&gt; (10,20) &amp; _1 .~ 30 &amp; _2 .~ 40
(30,40)

&gt;&gt;&gt; (10,20) &amp;~ do _1 .= 30; _2 .= 40
(30,40)

This does not support type-changing assignment, /e.g./

&gt;&gt;&gt; (10,20) &amp; _1 .~ &quot;hello&quot;
(&quot;hello&quot;,20)
-}</span><span>
</span><a name="line-145"></a><span class="hs-special">(</span><span class="hs-operator">&amp;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679039615"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">State</span><span> </span><a href="#local-6989586621679039615"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039616"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039615"><span class="hs-identifier hs-type">s</span></a><span>
</span><a name="line-146"></a><a name="local-6989586621679039633"><a href="#local-6989586621679039633"><span class="hs-identifier">s</span></a></a><span> </span><a name="%26~"><a href="Lens.Micro.Mtl.html#%26~"><span class="hs-operator">&amp;~</span></a></a><span> </span><a name="local-6989586621679039634"><a href="#local-6989586621679039634"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">execState</span><span> </span><a href="#local-6989586621679039634"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679039633"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-147"></a><span class="hs-pragma">{-# INLINE (&amp;~) #-}</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">{- |
Modify state by &#8220;assigning&#8221; a value to a part of the state.

This is merely ('.~') which works in 'MonadState':

@
l '.=' x = 'State.modify' (l '.~' x)
@

If you also want to know the value that was replaced by ('.='), use ('&lt;&lt;.=').
-}</span><span>
</span><a name="line-160"></a><span class="hs-special">(</span><span class="hs-operator">.=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039611"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039612"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039611"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039611"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039613"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039614"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039614"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039612"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><a name="local-6989586621679039635"><a href="#local-6989586621679039635"><span class="hs-identifier">l</span></a></a><span> </span><a name=".%3D"><a href="Lens.Micro.Mtl.html#.%3D"><span class="hs-operator">.=</span></a></a><span> </span><a name="local-6989586621679039636"><a href="#local-6989586621679039636"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">modify</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039635"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">.~</span><span> </span><a href="#local-6989586621679039636"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span class="hs-pragma">{-# INLINE (.=) #-}</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">{- |
A synonym for ('.=').
-}</span><span>
</span><a name="line-167"></a><span class="hs-identifier">assign</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039607"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039608"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039607"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039607"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039609"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039610"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039610"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039608"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><a name="assign"><a href="Lens.Micro.Mtl.html#assign"><span class="hs-identifier">assign</span></a></a><span> </span><a name="local-6989586621679039637"><a href="#local-6989586621679039637"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679039638"><a href="#local-6989586621679039638"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039637"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span> </span><a href="#local-6989586621679039638"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-169"></a><span class="hs-pragma">{-# INLINE assign #-}</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">{- |
('?=') is a version of ('.=') that wraps the value into 'Just' before setting.

@
l '?=' b = l '.=' Just b
@

It can be useful in combination with 'at'.
-}</span><span>
</span><a name="line-180"></a><span class="hs-special">(</span><span class="hs-operator">?=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039604"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039603"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039605"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039606"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039606"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039604"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><a name="local-6989586621679039639"><a href="#local-6989586621679039639"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3F%3D"><a href="Lens.Micro.Mtl.html#%3F%3D"><span class="hs-operator">?=</span></a></a><span> </span><a name="local-6989586621679039640"><a href="#local-6989586621679039640"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039639"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679039640"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-182"></a><span class="hs-pragma">{-# INLINE (?=) #-}</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">{- |
('&lt;~') is a version of ('.=') that takes a monadic value (and then executes it and assigns the result to the lens).

@
l '&lt;~' mb = do
  b &lt;- mb
  l '.=' b
@
-}</span><span>
</span><a name="line-193"></a><span class="hs-special">(</span><span class="hs-operator">&lt;~</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039599"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039600"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039599"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039599"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039601"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039602"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039600"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039602"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039600"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><a name="local-6989586621679039641"><a href="#local-6989586621679039641"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C~"><a href="Lens.Micro.Mtl.html#%3C~"><span class="hs-operator">&lt;~</span></a></a><span> </span><a name="local-6989586621679039642"><a href="#local-6989586621679039642"><span class="hs-identifier">mb</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039642"><span class="hs-identifier hs-var">mb</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039641"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#.%3D"><span class="hs-operator hs-var">.=</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span class="hs-pragma">{-# INLINE (&lt;~) #-}</span><span>
</span><a name="line-196"></a><span>
</span><a name="line-197"></a><span class="hs-comment">{- |
Modify state by applying a function to a part of the state. An example:

&gt;&gt;&gt; execState (do _1 %= (+1); _2 %= reverse) (1,&quot;hello&quot;)
(2,&quot;olleh&quot;)

Implementation:

@
l '%=' f = 'State.modify' (l '%~' f)
@

If you also want to get the value before\/after the modification, use ('&lt;&lt;%=')\/('&lt;%=').

There are a few specialised versions of ('%=') which mimic C operators:

* ('+=') for addition
* ('-=') for substraction
* ('*=') for multiplication
* ('//=') for division
-}</span><span>
</span><a name="line-218"></a><span class="hs-special">(</span><span class="hs-operator">%=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039595"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039596"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039595"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039595"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039597"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039598"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039597"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039598"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039596"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><a name="local-6989586621679039643"><a href="#local-6989586621679039643"><span class="hs-identifier">l</span></a></a><span> </span><a name="%25%3D"><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator">%=</span></a></a><span> </span><a name="local-6989586621679039644"><a href="#local-6989586621679039644"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">modify</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039643"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">%~</span><span> </span><a href="#local-6989586621679039644"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span class="hs-pragma">{-# INLINE (%=) #-}</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">{- |
A synonym for ('%=').
-}</span><span>
</span><a name="line-225"></a><span class="hs-identifier">modifying</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039591"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039592"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039591"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039591"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039593"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039594"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039593"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039594"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039592"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><a name="modifying"><a href="Lens.Micro.Mtl.html#modifying"><span class="hs-identifier">modifying</span></a></a><span> </span><a name="local-6989586621679039645"><a href="#local-6989586621679039645"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679039646"><a href="#local-6989586621679039646"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039645"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span> </span><a href="#local-6989586621679039646"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-227"></a><span class="hs-pragma">{-# INLINE modifying #-}</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">{- $arith-note

The following operators mimic well-known C operators ('+=', '-=', etc). ('//=') stands for division.

They're implemented like this:

@
l '+=' x = l '%=' (+x)
l '-=' x = l '%=' ('subtract' x)
...
@
-}</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-special">(</span><span class="hs-operator">+=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039589"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039588"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039590"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039589"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><a name="local-6989586621679039647"><a href="#local-6989586621679039647"><span class="hs-identifier">l</span></a></a><span> </span><a name="%2B%3D"><a href="Lens.Micro.Mtl.html#%2B%3D"><span class="hs-operator">+=</span></a></a><span> </span><a name="local-6989586621679039648"><a href="#local-6989586621679039648"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039647"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><a href="#local-6989586621679039648"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span class="hs-pragma">{-# INLINE (+=) #-}</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-special">(</span><span class="hs-operator">-=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039586"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039585"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039587"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039586"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-247"></a><a name="local-6989586621679039649"><a href="#local-6989586621679039649"><span class="hs-identifier">l</span></a></a><span> </span><a name="-%3D"><a href="Lens.Micro.Mtl.html#-%3D"><span class="hs-operator">-=</span></a></a><span> </span><a name="local-6989586621679039650"><a href="#local-6989586621679039650"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039649"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">subtract</span><span> </span><a href="#local-6989586621679039650"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span class="hs-pragma">{-# INLINE (-=) #-}</span><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-special">(</span><span class="hs-operator">*=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039582"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039583"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039582"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039582"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039584"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039583"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><a name="local-6989586621679039651"><a href="#local-6989586621679039651"><span class="hs-identifier">l</span></a></a><span> </span><a name="%2A%3D"><a href="Lens.Micro.Mtl.html#%2A%3D"><span class="hs-operator">*=</span></a></a><span> </span><a name="local-6989586621679039652"><a href="#local-6989586621679039652"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039651"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><a href="#local-6989586621679039652"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span class="hs-pragma">{-# INLINE (*=) #-}</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-special">(</span><span class="hs-operator">//=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ASetter</span><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039579"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039581"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039580"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><a name="local-6989586621679039653"><a href="#local-6989586621679039653"><span class="hs-identifier">l</span></a></a><span> </span><a name="%2F%2F%3D"><a href="Lens.Micro.Mtl.html#%2F%2F%3D"><span class="hs-operator">//=</span></a></a><span> </span><a name="local-6989586621679039654"><a href="#local-6989586621679039654"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039653"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%3D"><span class="hs-operator hs-var">%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><a href="#local-6989586621679039654"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span class="hs-pragma">{-# INLINE (//=) #-}</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">{- |
Modify state and return the modified (new) value.

@
l '&lt;%=' f = do
  l '%=' f
  'use' l
@
-}</span><span>
</span><a name="line-267"></a><span class="hs-special">(</span><span class="hs-operator">&lt;%=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039575"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039578"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039578"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039576"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039577"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-268"></a><a name="local-6989586621679039655"><a href="#local-6989586621679039655"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%25%3D"><a href="Lens.Micro.Mtl.html#%3C%25%3D"><span class="hs-operator">&lt;%=</span></a></a><span> </span><a name="local-6989586621679039656"><a href="#local-6989586621679039656"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039655"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679039657"><a href="#local-6989586621679039657"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039657"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039657"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679039656"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-269"></a><span class="hs-pragma">{-# INLINE (&lt;%=) #-}</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">{- |
Modify state and return the old value (i.e. as it was before the modificaton).

@
l '&lt;&lt;%=' f = do
  old &lt;- 'use' l
  l '%=' f
  return old
@
-}</span><span>
</span><a name="line-281"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;%=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039572"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039571"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039573"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039574"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039572"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039573"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-282"></a><a name="local-6989586621679039658"><a href="#local-6989586621679039658"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C%25%3D"><a href="Lens.Micro.Mtl.html#%3C%3C%25%3D"><span class="hs-operator">&lt;&lt;%=</span></a></a><span> </span><a name="local-6989586621679039659"><a href="#local-6989586621679039659"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039658"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679039660"><a href="#local-6989586621679039660"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039660"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039659"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679039660"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span class="hs-pragma">{-# INLINE (&lt;&lt;%=) #-}</span><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-comment">{- |
Set state and return the old value.

@
l '&lt;&lt;.=' b = do
  old &lt;- 'use' l
  l '.=' b
  return old
@
-}</span><span>
</span><a name="line-295"></a><span class="hs-special">(</span><span class="hs-operator">&lt;&lt;.=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039567"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039570"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039570"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039568"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039569"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-296"></a><a name="local-6989586621679039661"><a href="#local-6989586621679039661"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3C.%3D"><a href="Lens.Micro.Mtl.html#%3C%3C.%3D"><span class="hs-operator">&lt;&lt;.=</span></a></a><span> </span><a name="local-6989586621679039662"><a href="#local-6989586621679039662"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039661"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679039663"><a href="#local-6989586621679039663"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039663"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039662"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span class="hs-pragma">{-# INLINE (&lt;&lt;.=) #-}</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-comment">{- |
Set state and return new value.

@
l '&lt;.=' b = do
  l '.=' b
  return b
@
-}</span><span>
</span><a name="line-308"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039564"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039563"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039566"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039564"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039565"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-309"></a><a name="local-6989586621679039664"><a href="#local-6989586621679039664"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C.%3D"><a href="Lens.Micro.Mtl.html#%3C.%3D"><span class="hs-operator">&lt;.=</span></a></a><span> </span><a name="local-6989586621679039665"><a href="#local-6989586621679039665"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039664"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%3C%25%3D"><span class="hs-operator hs-var">&lt;%=</span></a><span> </span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679039665"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-310"></a><span class="hs-pragma">{-# INLINE (&lt;.=) #-}</span><span>
</span><a name="line-311"></a><span>
</span><a name="line-312"></a><span class="hs-comment">{- |
('&lt;?=') is a version of ('&lt;.=') that wraps the value into 'Just' before setting.

@
l '&lt;?=' b = do
  l '.=' Just b
  'return' b
@

It can be useful in combination with 'at'.
-}</span><span>
</span><a name="line-323"></a><span class="hs-special">(</span><span class="hs-operator">&lt;?=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039559"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039562"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039560"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039561"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-324"></a><a name="local-6989586621679039666"><a href="#local-6989586621679039666"><span class="hs-identifier">l</span></a></a><span> </span><a name="%3C%3F%3D"><a href="Lens.Micro.Mtl.html#%3C%3F%3D"><span class="hs-operator">&lt;?=</span></a></a><span> </span><a name="local-6989586621679039667"><a href="#local-6989586621679039667"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679039666"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="Lens.Micro.Mtl.html#%25%25%3D"><span class="hs-operator hs-var">%%=</span></a><span> </span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039667"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679039667"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-325"></a><span class="hs-pragma">{-# INLINE (&lt;?=) #-}</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-special">(</span><span class="hs-operator">%%=</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039555"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">LensLike</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039556"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039554"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039557"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039556"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679039558"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679039555"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679039556"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-328"></a><span class="hs-cpp">#if MIN_VERSION_mtl(2,1,1)</span><span>
</span><a name="line-329"></a><a name="local-6989586621679039668"><a href="#local-6989586621679039668"><span class="hs-identifier">l</span></a></a><span> </span><a name="%25%25%3D"><a href="Lens.Micro.Mtl.html#%25%25%3D"><span class="hs-operator">%%=</span></a></a><span> </span><a name="local-6989586621679039669"><a href="#local-6989586621679039669"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">State</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">state</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679039668"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679039669"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-331"></a><span class="hs-identifier">l</span><span> </span><span class="hs-operator">%%=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-332"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">r</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">gets</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">l</span><span> </span><span class="hs-identifier">f</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>  </span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">put</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-334"></a><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-335"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-336"></a><span class="hs-pragma">{-# INLINE (%%=) #-}</span><span>
</span><a name="line-337"></a><span>
</span><a name="line-338"></a><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator">%%=</span><span>
</span><a name="line-339"></a></pre></body></html>